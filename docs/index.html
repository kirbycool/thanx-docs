
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-a1ce949a.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-bccf8c07.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;curl&quot;,&quot;ruby&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-e1fcda57.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="curl">curl</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#environments" class="toc-h2 toc-link" data-title="Environments">Environments</a>
                  </li>
                  <li>
                    <a href="#credentials" class="toc-h2 toc-link" data-title="Credentials">Credentials</a>
                  </li>
                  <li>
                    <a href="#headers" class="toc-h2 toc-link" data-title="Headers">Headers</a>
                  </li>
                  <li>
                    <a href="#request-signature" class="toc-h2 toc-link" data-title="Request Signature">Request Signature</a>
                  </li>
                  <li>
                    <a href="#errors" class="toc-h2 toc-link" data-title="Errors">Errors</a>
                  </li>
                  <li>
                    <a href="#patterns" class="toc-h2 toc-link" data-title="Patterns">Patterns</a>
                  </li>
                  <li>
                    <a href="#legal-requirements" class="toc-h2 toc-link" data-title="Legal requirements">Legal requirements</a>
                  </li>
                  <li>
                    <a href="#certification" class="toc-h2 toc-link" data-title="Certification">Certification</a>
                  </li>
                  <li>
                    <a href="#push-notifications" class="toc-h2 toc-link" data-title="Push Notifications">Push Notifications</a>
                  </li>
                  <li>
                    <a href="#mobile-app-support" class="toc-h2 toc-link" data-title="Mobile App Support">Mobile App Support</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#users" class="toc-h1 toc-link" data-title="Users">Users</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-user" class="toc-h2 toc-link" data-title="Get user">Get user</a>
                  </li>
                  <li>
                    <a href="#create-user" class="toc-h2 toc-link" data-title="Create user">Create user</a>
                  </li>
                  <li>
                    <a href="#update-user" class="toc-h2 toc-link" data-title="Update user">Update user</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#sso" class="toc-h1 toc-link" data-title="SSO">SSO</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#legal-requirements" class="toc-h2 toc-link" data-title="Legal Requirements">Legal Requirements</a>
                  </li>
                  <li>
                    <a href="#acquire-authorization-code" class="toc-h2 toc-link" data-title="Acquire authorization code">Acquire authorization code</a>
                  </li>
                  <li>
                    <a href="#acquire-access-token" class="toc-h2 toc-link" data-title="Acquire access token">Acquire access token</a>
                  </li>
                  <li>
                    <a href="#revoke-access-token" class="toc-h2 toc-link" data-title="Revoke Access Token">Revoke Access Token</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#features" class="toc-h1 toc-link" data-title="Features">Features</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-features" class="toc-h2 toc-link" data-title="Get Features">Get Features</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#cards" class="toc-h1 toc-link" data-title="Cards">Cards</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-cards" class="toc-h2 toc-link" data-title="Describe Cards">Describe Cards</a>
                  </li>
                  <li>
                    <a href="#get-signature" class="toc-h2 toc-link" data-title="Get Signature">Get Signature</a>
                  </li>
                  <li>
                    <a href="#create-card" class="toc-h2 toc-link" data-title="Create Card">Create Card</a>
                  </li>
                  <li>
                    <a href="#delete-card" class="toc-h2 toc-link" data-title="Delete Card">Delete Card</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#rewards" class="toc-h1 toc-link" data-title="Rewards">Rewards</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-rewards" class="toc-h2 toc-link" data-title="Describe Rewards">Describe Rewards</a>
                  </li>
                  <li>
                    <a href="#get-single-reward" class="toc-h2 toc-link" data-title="Get Single Reward">Get Single Reward</a>
                  </li>
                  <li>
                    <a href="#activate-reward" class="toc-h2 toc-link" data-title="Activate Reward">Activate Reward</a>
                  </li>
                  <li>
                    <a href="#finalize-reward" class="toc-h2 toc-link" data-title="Finalize Reward">Finalize Reward</a>
                  </li>
                  <li>
                    <a href="#grant-reward" class="toc-h2 toc-link" data-title="Grant Reward">Grant Reward</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#tags" class="toc-h1 toc-link" data-title="Tags">Tags</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-tags" class="toc-h2 toc-link" data-title="Describe Tags">Describe Tags</a>
                  </li>
                  <li>
                    <a href="#update-tags" class="toc-h2 toc-link" data-title="Update Tags">Update Tags</a>
                  </li>
                  <li>
                    <a href="#delete-tag" class="toc-h2 toc-link" data-title="Delete Tag">Delete Tag</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#communication-settings" class="toc-h1 toc-link" data-title="Communication Settings">Communication Settings</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-communication-settings" class="toc-h2 toc-link" data-title="Get Communication Settings">Get Communication Settings</a>
                  </li>
                  <li>
                    <a href="#update-communication-settings" class="toc-h2 toc-link" data-title="Update Communication Settings">Update Communication Settings</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#push-registrations" class="toc-h1 toc-link" data-title="Push Registrations">Push Registrations</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-push-registration" class="toc-h2 toc-link" data-title="Create Push Registration">Create Push Registration</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#loyalty" class="toc-h1 toc-link" data-title="Loyalty">Loyalty</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-loyalty-status" class="toc-h2 toc-link" data-title="Describe Loyalty Status">Describe Loyalty Status</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#tiers" class="toc-h1 toc-link" data-title="Tiers">Tiers</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-tiers-configuration" class="toc-h2 toc-link" data-title="Describe Tiers Configuration">Describe Tiers Configuration</a>
                  </li>
                  <li>
                    <a href="#describe-tier-status" class="toc-h2 toc-link" data-title="Describe Tier Status">Describe Tier Status</a>
                  </li>
                  <li>
                    <a href="#grant-tier-status" class="toc-h2 toc-link" data-title="Grant Tier Status">Grant Tier Status</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#feedbacks" class="toc-h1 toc-link" data-title="Feedbacks">Feedbacks</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-feedback" class="toc-h2 toc-link" data-title="Describe Feedback">Describe Feedback</a>
                  </li>
                  <li>
                    <a href="#get-single-feedback" class="toc-h2 toc-link" data-title="Get Single Feedback">Get Single Feedback</a>
                  </li>
                  <li>
                    <a href="#update-feedback" class="toc-h2 toc-link" data-title="Update Feedback">Update Feedback</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#purchases" class="toc-h1 toc-link" data-title="Purchases">Purchases</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-purchases" class="toc-h2 toc-link" data-title="Describe Purchases">Describe Purchases</a>
                  </li>
                  <li>
                    <a href="#get-single-purchase" class="toc-h2 toc-link" data-title="Get Single Purchase">Get Single Purchase</a>
                  </li>
                  <li>
                    <a href="#create-purchase" class="toc-h2 toc-link" data-title="Create Purchase">Create Purchase</a>
                  </li>
                  <li>
                    <a href="#update-purchase-tags" class="toc-h2 toc-link" data-title="Update Purchase Tags">Update Purchase Tags</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#receipts" class="toc-h1 toc-link" data-title="Receipts">Receipts</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-presigned-url" class="toc-h2 toc-link" data-title="Describe Presigned URL">Describe Presigned URL</a>
                  </li>
                  <li>
                    <a href="#describe-receipts" class="toc-h2 toc-link" data-title="Describe Receipts">Describe Receipts</a>
                  </li>
                  <li>
                    <a href="#create-receipt" class="toc-h2 toc-link" data-title="Create Receipt">Create Receipt</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#referrals" class="toc-h1 toc-link" data-title="Referrals">Referrals</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-referral-links" class="toc-h2 toc-link" data-title="Describe Referral Links">Describe Referral Links</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#locations" class="toc-h1 toc-link" data-title="Locations">Locations</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#describe-locations" class="toc-h2 toc-link" data-title="Describe Locations">Describe Locations</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#sdk-ios" class="toc-h1 toc-link" data-title="SDK iOS">SDK iOS</a>
          </li>
          <li>
            <a href="#sdk-android" class="toc-h1 toc-link" data-title="SDK Android">SDK Android</a>
          </li>
          <li>
            <a href="#webhooks" class="toc-h1 toc-link" data-title="Webhooks">Webhooks</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#purchase-data" class="toc-h2 toc-link" data-title="Purchase Data">Purchase Data</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#legacy-sso" class="toc-h1 toc-link" data-title="[LEGACY] SSO">[LEGACY] SSO</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#thanx-hosted-sso-form" class="toc-h2 toc-link" data-title="Thanx-hosted SSO Form">Thanx-hosted SSO Form</a>
                  </li>
                  <li>
                    <a href="#self-hosted-sso-form" class="toc-h2 toc-link" data-title="Self-hosted SSO Form">Self-hosted SSO Form</a>
                  </li>
                  <li>
                    <a href="#send-user-to-authentication-flow" class="toc-h2 toc-link" data-title="Send user to authentication flow">Send user to authentication flow</a>
                  </li>
                  <li>
                    <a href="#acquire-authorization-code" class="toc-h2 toc-link" data-title="Acquire authorization code">Acquire authorization code</a>
                  </li>
                  <li>
                    <a href="#acquire-access-token" class="toc-h2 toc-link" data-title="Acquire access token">Acquire access token</a>
                  </li>
                  <li>
                    <a href="#revoke-access-token" class="toc-h2 toc-link" data-title="Revoke Access Token">Revoke Access Token</a>
                  </li>
                  <li>
                    <a href="#describe-user" class="toc-h2 toc-link" data-title="Describe User">Describe User</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#legacy-identity" class="toc-h1 toc-link" data-title="[LEGACY] Identity">[LEGACY] Identity</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-user" class="toc-h2 toc-link" data-title="Create user">Create user</a>
                  </li>
                  <li>
                    <a href="#describe-user" class="toc-h2 toc-link" data-title="Describe user">Describe user</a>
                  </li>
                  <li>
                    <a href="#describe-users" class="toc-h2 toc-link" data-title="Describe users">Describe users</a>
                  </li>
                  <li>
                    <a href="#update-user" class="toc-h2 toc-link" data-title="Update user">Update user</a>
                  </li>
                  <li>
                    <a href="#create-access-token" class="toc-h2 toc-link" data-title="Create access token">Create access token</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#legacy-ordering-loyalty-integration" class="toc-h1 toc-link" data-title="[LEGACY] Ordering / Loyalty Integration">[LEGACY] Ordering / Loyalty Integration</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#custom-ordering-ui" class="toc-h2 toc-link" data-title="Custom Ordering UI">Custom Ordering UI</a>
                  </li>
                  <li>
                    <a href="#headers" class="toc-h2 toc-link" data-title="Headers">Headers</a>
                  </li>
                  <li>
                    <a href="#retrieve-account" class="toc-h2 toc-link" data-title="Retrieve Account">Retrieve Account</a>
                  </li>
                  <li>
                    <a href="#create-amp-update-basket" class="toc-h2 toc-link" data-title="Create &amp; Update Basket">Create &amp; Update Basket</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://www.thanx.com/' target='_blank'>About Thanx</a></li>
            <li><a href='mailto:developer-support@thanx.com'>Contact Developer Support</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Thanx provides a number of ways to integrate with the Thanx platform, including
a number of authentication mechanisms and a powerful REST API.</p>

<p>This API reference provides information on available endpoints and how to
interact with them.</p>
<h2 id='environments'>Environments</h2>
<p>Thanx provides a sandbox environment for you to develop against. The data in the
sandbox environment is isolated from production data.</p>

<p>The sandbox API can be found at:</p>

<p><code>https://api.thanxsandbox.com</code></p>

<p>The production API can be found at:</p>

<p><code>https://api.thanx.com</code></p>
<h2 id='credentials'>Credentials</h2>
<p>Thanx will provide you with a Client ID and Client Secret to use in communicating
with our API. These values will be different for sandbox and production. We strongly
recommend that these credentials are never used in an app build for security reasons.
You should proxy your app&#39;s calls to Thanx resources through your own server whenever possible.</p>
<h2 id='headers'>Headers</h2>
<p>This section describes the headers expected by the Thanx API.</p>

<table><thead>
<tr>
<th>Header</th>
<th>Example</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>Authorization</code></td>
<td><code>Bearer d6d6533c5ab9b528526f3e48a51e90b62</code></td>
<td>Optional</td>
<td>All Thanx Loyalty API endpoints are protected and must be authorized via end user access tokens. These access tokens can be retrieved through an integration with Thanx SSO. The format of the header should be: <code>Bearer access_token</code>. Some endpoints don&#39;t require a user to be signed in; these are called out in their separate sections.</td>
</tr>
<tr>
<td><code>Content-Type</code></td>
<td><code>application/json</code></td>
<td>Optional</td>
<td>The only accepted value is <code>application/json</code> or empty if no body</td>
</tr>
<tr>
<td><code>Accept-Version</code></td>
<td><code>v4.0</code></td>
<td>Required</td>
<td>The Accept-Version header specifies which version of the Thanx API that should be used. The current version is <code>v4.0</code>. This header is required for every request. Thanx will notify you when a new API version is available.</td>
</tr>
<tr>
<td><code>Accept</code></td>
<td><code>application/json</code></td>
<td>Required</td>
<td>The only accepted value is <code>application/json</code></td>
</tr>
<tr>
<td><code>X-ClientId</code></td>
<td><code>f050d74b5c2b12ae17c85bd510addd7ba2</code></td>
<td>Required</td>
<td>Thanx will provide you with this value.</td>
</tr>
<tr>
<td><code>X-Signature</code></td>
<td><code>wGlo9uwpPHggRhFupSYjEkfHXhTf1uruek=</code></td>
<td>Optional</td>
<td>This should be computed on a per-request basis following the algorithm described below.</td>
</tr>
<tr>
<td><code>Date</code></td>
<td><code>Thu, 06 Oct 2011 02:26:12 GMT</code></td>
<td>Required</td>
<td>This timestamp must be within 5 minutes of Thanx server time.</td>
</tr>
</tbody></table>
<pre class="highlight plaintext tab-plaintext"><code>STANDARD_HEADERS = '-H "Content-Type: application/json" ' \
  '-H "Accept-Version: v4.0" '\
  '-H "Accept: application/json" '\
  '-H "X-ClientId: 293487fhs98345yswoeir245789" '\
  '-H "Date: Thu, 06 Oct 2011 02:26:12 GMT"'

AUTH_HEADERS = '-H "Content-Type: application/json" ' \
  '-H "Accept-Version: v4.0" '\
  '-H "Accept: application/json" '\
  '-H "Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd" '\
  '-H "X-ClientId: 293487fhs98345yswoeir245789" '\
  '-H "Date: Thu, 06 Oct 2011 02:26:12 GMT"'
</code></pre><h2 id='request-signature'>Request Signature</h2>
<p>Thanx suggests that you provide a signature with every request. Thanx will validate this signature. This is an extra security
feature that provides a guarantee that a request was not tampered with on its way from client to server.</p>
<pre class="highlight plaintext tab-plaintext"><code>Pseudocode:
stringToSign = string.Join(
  ",",
  ClientId,
  HttpVerb,
  HttpContentType,
  Base64(SHA256(HttpBody)),
  UriPathAndQuery
)

signature = Base64(HMAC-SHA256(ClientSecret, UTF8(stringToSign)))
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="k">def</span> <span class="nf">generate_signature</span><span class="p">(</span><span class="n">client_id</span><span class="p">:,</span> <span class="n">client_secret</span><span class="p">:,</span> <span class="n">verb</span><span class="p">:,</span> <span class="n">content_type</span><span class="p">:,</span> <span class="n">body</span><span class="p">:,</span> <span class="ss">path: </span><span class="p">)</span>
  <span class="n">string_to_sign</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">client_id</span><span class="p">,</span>
    <span class="n">verb</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">,</span>
    <span class="no">Base64</span><span class="p">.</span><span class="nf">encode64</span><span class="p">(</span><span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">digest</span><span class="p">(</span><span class="n">body</span><span class="p">)).</span><span class="nf">strip</span><span class="p">,</span>
    <span class="n">path</span>
  <span class="p">].</span><span class="nf">join</span><span class="p">(</span><span class="s2">","</span><span class="p">)</span>

  <span class="no">Base64</span><span class="p">.</span><span class="nf">encode64</span><span class="p">(</span>
    <span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">digest</span><span class="p">(</span>
      <span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span><span class="p">.</span><span class="nf">new</span><span class="p">,</span>
      <span class="n">client_secret</span><span class="p">,</span>
      <span class="n">string_to_sign</span>
    <span class="p">)</span>
  <span class="p">).</span><span class="nf">strip</span>
<span class="k">end</span>

<span class="c1"># Using Faraday Middleware objects</span>
<span class="n">generate_signature</span><span class="p">(</span>
  <span class="ss">client_id:     </span><span class="s1">'f050d74b5c2b12ae17c85bd510addd7ba2'</span><span class="p">,</span>
  <span class="ss">client_secret: </span><span class="s1">'17c85bd510ad74b5c2b15bd510ad'</span><span class="p">,</span>
  <span class="ss">verb:          </span><span class="n">env</span><span class="p">.</span><span class="nf">method</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">upcase</span><span class="p">,</span>
  <span class="ss">content_type:  </span><span class="n">env</span><span class="p">.</span><span class="nf">request_headers</span><span class="p">[</span><span class="s1">'content-type'</span><span class="p">],</span>
  <span class="ss">body:          </span><span class="n">env</span><span class="p">.</span><span class="nf">body</span><span class="p">.</span><span class="nf">present?</span> <span class="p">?</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">dump</span><span class="p">(</span><span class="n">env</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span> <span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="ss">path:          </span><span class="n">env</span><span class="p">.</span><span class="nf">url</span><span class="p">.</span><span class="nf">request_uri</span>
<span class="p">)</span>

<span class="c1"># Explicit example for granting a reward</span>
<span class="n">generate_signature</span><span class="p">(</span>
  <span class="ss">client_id:     </span><span class="s2">"f050d74b5c2b12ae17c85bd510addd7ba2"</span><span class="p">,</span>
  <span class="ss">client_secret: </span><span class="s2">"17c85bd510ad74b5c2b15bd510ad"</span><span class="p">,</span>
  <span class="ss">verb:          </span><span class="s2">"POST"</span><span class="p">,</span>
  <span class="ss">content_type:  </span><span class="s2">"application/json"</span><span class="p">,</span>
  <span class="ss">body:          </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">reward</span><span class="se">\"</span><span class="s2">:{</span><span class="se">\"</span><span class="s2">user_id</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">weoru</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">campaign_id</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">weroui234890f</span><span class="se">\"</span><span class="s2">}}"</span><span class="p">,</span>
  <span class="ss">path:          </span><span class="s2">"/rewards"</span>
<span class="p">)</span>
<span class="o">=&gt;</span> <span class="s2">"d7hgl0OhIdfGhLRYZPzNgNxF0jxQXpGerPXwNuw9UsU="</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="kr">const</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">method</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span>
<span class="kr">const</span> <span class="nx">pathAndQuery</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/https</span><span class="se">?</span><span class="sr">:</span><span class="se">\/{2}[^\/]</span><span class="sr">+</span><span class="se">\/</span><span class="sr">/i</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">payload</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">?</span> <span class="s1">''</span> <span class="p">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">SHA256</span><span class="p">(</span><span class="nx">payload</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">stringToSign</span> <span class="o">=</span> <span class="p">[</span><span class="nx">clientId</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">contentType</span><span class="p">,</span>
                      <span class="nx">body</span><span class="p">,</span> <span class="nx">pathAndQuery</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">','</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">stringToSign</span><span class="p">,</span> <span class="nx">clientSecret</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">);</span>
</code></pre>
<ol>
<li><p>Assemble the components of the string that will be signed:</p>

<ul>
<li>Client ID</li>
<li>Request method (GET, POST, PATCH, PUT, DELETE)</li>
<li>Content Type (same as the header value or empty string if no body)</li>
<li>The request body (empty string if no body)</li>
<li>The request path</li>
</ul></li>
<li><p>Base64 encode the body after creating a digest using SHA-256.</p></li>
<li><p>Join these strings together, with a comma separator.</p></li>
<li><p>Create a digest using HMAC &amp; SHA-256.</p></li>
<li><p>Base64 encode the digest.</p></li>
<li><p>This value is your signature header.</p></li>
</ol>

<p>See examples to the right.</p>
<h2 id='errors'>Errors</h2>
<p>Thanx uses standard HTTP error codes to communicate the success / failure of a request.</p>

<blockquote>
<p>Response (401 Unauthorized)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="w">    </span><span class="s2">"AUTHENTICATION_GENERIC"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There was an error authenticating you."</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (404 NOT FOUND)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RESOURCE_NOT_FOUND"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The resource you requested was not found."</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (400 Bad Request)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USER_EMAIL_INVALID"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The email entered is invalid."</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>An HTTP 400 Bad Request will always be accompanied by an object containing
two properties: code (see below) and message. The code will remain static though
the associated message may change at any time. Thanx can expand this list at any time.</p>

<table><thead>
<tr>
<th>Code</th>
<th>Sample Message</th>
</tr>
</thead><tbody>
<tr>
<td>GENERIC_ERROR</td>
<td>&quot;Something went wrong&quot;</td>
</tr>
<tr>
<td>RESOURCE_NOT_FOUND</td>
<td>&quot;The resource you requested was not found.&quot;</td>
</tr>
<tr>
<td>AUTHENTICATION_GENERIC</td>
<td>&quot;There was an error authenticating you.&quot;</td>
</tr>
<tr>
<td>USER_EMAIL_INVALID</td>
<td>&quot;The email entered is invalid.&quot;</td>
</tr>
<tr>
<td>USER_PHONE_INVALID</td>
<td>&quot;The phone entered is invalid.&quot;</td>
</tr>
<tr>
<td>USER_NAME_REQUIRED</td>
<td>&quot;First and last name are required fields.&quot;</td>
</tr>
<tr>
<td>REWARD_ALREADY_USED</td>
<td>&quot;This reward has already been used.&quot;</td>
</tr>
<tr>
<td>REWARD_EXPIRED</td>
<td>&quot;This reward is no longer valid.&quot;</td>
</tr>
<tr>
<td>REWARD_INAPPLICABLE</td>
<td>&quot;Required item not present.&quot;</td>
</tr>
<tr>
<td>REWARD_FRAUDULENT</td>
<td>&quot;You appear to have already used one of these rewards.&quot;</td>
</tr>
<tr>
<td>CARD_GENERIC</td>
<td>&quot;Unable to register this card due to an issue at Visa.&quot;</td>
</tr>
<tr>
<td>CARD_INVALID</td>
<td>&quot;This type of card is not accepted.&quot;</td>
</tr>
</tbody></table>
<h2 id='patterns'>Patterns</h2>
<p>This section calls out some patterns in this API.</p>

<ul>
<li>Every ID returned by the API is an alphanumeric, lowercase string.</li>
<li>Every endpoint&#39;s payload contains a top-level key (aside from SSO).</li>
<li>A bearer token is required for a user to access their own resources. If an endpoint
provides filtering by <code>user_id</code> and the bearer token is provided, the <code>user_id</code> filter is ignored.</li>
</ul>
<h2 id='legal-requirements'>Legal requirements</h2><h3 id='general-requirements'>General requirements</h3>
<p>User must be able to navigate to the Thanx Privacy Policy and Terms of Service from the App and the Web Ordering experience after initial sign up has completed when they are using the app on an ongoing basis. Linking to the Thanx Terms of Service and Privacy Policy from another like document that is readily available in the app is sufficient.</p>
<h3 id='user-creation'>User creation</h3>
<p>When a user is created, the following sentence must be displayed, with links to the Thanx Terms of Service (https://app.thanx.com/terms) and the Thanx Privacy Policy (https://app.thanx.com/privacy). Note that you may style this sentence as you&#39;d like.</p>

<p><em>By signing up, you agree to the Thanx <a href="app.thanx.com/terms"><strong>Terms Of Service</strong></a> and <a href="app.thanx.com/privacy"><strong>Privacy Policy</strong></a></em></p>
<h3 id='card-linkage'>Card linkage</h3>
<p>Any screen that leverages the Thanx card linkage SDK to register credit cards for loyalty tracking with the major card networks (Visa, Mastercard, Amex) must be explicitly approved by the Thanx team for design and content.</p>
<h2 id='certification'>Certification</h2>
<p>When you are ready for your integration to be certified, let your customer success representative know.
Certification will take a week. If certification fails, the 1 week timeline will begin again.</p>

<p>Upon certification of your integration in the Sandbox environment, you will be provided
with a set of production credentials that will allow you access to our Production environment.</p>

<p>The goal of certification is to ensure that your integration uses the Thanx API correctly and is set up
to be successful long-term.</p>
<h3 id='certification-checklist'>Certification Checklist:</h3>
<p>Notes: In the below list the term &quot;experience&quot; is used to refer to both app and web.</p>
<h4 id='legal-requirements'>Legal Requirements</h4>
<ul>
<li>Experience should show terms and conditions during signup</li>
<li>Experience should implement special Visa flow

<ul>
<li>The text blobs below the card information fields are required</li>
<li>Two buttons for saving the card are required: one should enroll the card with Thanx and the other should not
<img src="images/cards/linkage-57c0cfa2.png" width="300"/></li>
</ul></li>
</ul>
<h4 id='general'>General</h4>
<ul>
<li>API requests should be authenticated when a user is logged in</li>
<li>API requests should contain all required headers</li>
<li>API error messages should be displayed to the user</li>
<li>Experience should not make API requests more often than necessary</li>
</ul>
<h4 id='sso-requirements'>SSO requirements</h4>
<ul>
<li>Users should be required to provide a name to complete registration</li>
<li>A new user should be prompted to sign up</li>
<li>An existing user should be sent a login email (experience should display a message about an email being sent)</li>
<li>A user should be able to update their birthday and name</li>
</ul>
<h4 id='cards-requirements'>Cards requirements</h4>
<ul>
<li>Experience should support displaying a list of cards</li>
<li>Experience should allow a user to link a card (Visa, Mastercard, American Express)</li>
<li>Experience should allow a user to delete a card</li>
</ul>
<h4 id='rewards-requirements'>Rewards requirements</h4>
<ul>
<li>Experience should display all available rewards</li>
<li>Experience should allow the user to activate their reward</li>
<li>Reward activation request should be made only on user action</li>
<li>Manual redemption rewards should display a countdown timer</li>
<li>Rewards should be correctly marked as used</li>
</ul>
<h4 id='receipts-requirements'>Receipts requirements</h4>
<ul>
<li>Experience should request all required information from the user</li>
<li>Experience should allow the user to choose a card to associate the receipt with, if they have any</li>
</ul>
<h4 id='feedback-requirements'>Feedback requirements</h4>
<ul>
<li>Experience should submit numerical rating and optional text feedback</li>
<li>Experience should present the option to leave text feedback for each purchase</li>
<li>Rating should be on a 10 point scale</li>
</ul>
<h4 id='communication-settings-requirements'>Communication settings requirements</h4>
<ul>
<li>Experience should provide ability for user to edit communication settings</li>
</ul>
<h4 id='push-registrations-requirements'>Push Registrations requirements</h4>
<ul>
<li>App should make a call to register a user for push notifications after user confirmation</li>
</ul>
<h4 id='tags-requirements'>Tags requirements</h4>
<ul>
<li>Experience should correctly write + delete tags (if applicable)</li>
</ul>
<h3 id='production-launch-requirements'>Production Launch Requirements</h3>
<ul>
<li>APNS push notification certificate should be provided to Thanx</li>
<li>FCM server key and server ID should be provided to Thanx</li>
</ul>
<h2 id='push-notifications'>Push Notifications</h2>
<p>Thanx sends users push notifications in a variety of situations, such as when
they make a purchase or earn a reward. We can send push notifications to your app
as well. When you are ready to register your app with Thanx for push notifications,
you should send your CSM at Thanx your APNS certificate, FCM server key, and sender ID
via a secure mechanism, such as Dropbox Transfer.</p>

<p>The rest of this page provides information regarding the types of push notifications
that Thanx currently sends.</p>

<p>A push notification payload will contain an event key and a merchant key. Each notification type may have other information provided. The sample notification text provided is not set in stone and will
sometimes vary depending on the kinds of campaigns a merchant is running.</p>
<pre class="highlight plaintext"><code>Notification object example for iOS:
{
  aps: {
    "alert": "You just made your first purchase at Pizza Merchant! You're now 56% towards your next reward here!",
    "badge": 1,
    "sound": "default",
    "content-available": 1
  }
  "merchant_id": "oiu234oiurw",
  "event":       "purchase_discount_applied",
  "purchase_id": "wotu310589"
}

Notification object example for Android:
{
  "content_available": true,
  "data": {
    "message": "You just made your first purchase at Pizza Merchant! You're now 56% towards your next reward here!",
    "merchant_id": "oiu234oiurw",
    "event":       "purchase_discount_applied",
    "purchase_id": "wotu310589"
  },
  "notification": {
    "title": "You just made your first purchase at Pizza Merchant! You're now 56% towards your next reward here!"
  }
}
</code></pre><h3 id='purchase-notifications'>Purchase notifications</h3>
<p>When a user makes a purchase, one of the following notifications is sent:</p>
<h4 id='discount-applied'>Discount Applied</h4>
<p>A user activated a statement credit reward, and this reward was applied to
the purchase.</p>

<p><i>Thanx! You just saved $10 at Pizza Merchant!
It&#39;ll show up on your credit card statement in about two days.</i></p>

<p><code>event: :purchase_discount_applied</code></p>

<p>Additional payload keys:</p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='reward-unlocked'>Reward Unlocked</h4>
<p>A user unlocked a reward by making this purchase. This reward would have been
received as a result of a referral.</p>

<p><i>The reward ($5 off) you got from Alice for signing up is now available for you to use.</i></p>

<p><code>event: :referral_reward_unlocked</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>
<h4 id='granted'>Granted</h4>
<p>A user&#39;s receipt was accepted and they were granted progress toward their loyalty reward.</p>

<p><i>Heads up: Pizza Merchant granted you credit for $15.63 toward your next reward.</i></p>

<p><code>event: :progress_granted</code></p>

<p>Additional payload keys:</p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='under-minimum'>Under Minimum</h4>
<p>A user had activated a statement credit reward, but didn&#39;t spend enough money on their subsequent purchase.</p>

<p><i>We couldn&#39;t apply your statement credit reward at Pizza Merchant - it was less than the $25 minimum! We&#39;ll try to apply it to your next purchase.</i></p>

<p><code>event: :reward_under_minimum</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='reward-earned'>Reward Earned</h4>
<p>This purchase resulted in a user earning their loyalty reward.</p>

<p><i>Cha-ching! You just earned $10 off your purchase at Pizza Merchant! Open up Pizza Merchant and activate it when you&#39;re ready to use it.</i></p>

<p><code>event: :purchase_reward_earned</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='initial-purchase'>Initial Purchase</h4>
<p>The user made their first purchase.</p>

<p><i>You just made your first purchase at Pizza Merchant! You&#39;re now 56% towards your next reward here!</i></p>

<p><code>event: :first_purchase</code></p>

<p>Additional payload keys:</p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='reward-unused'>Reward Unused</h4>
<p>A user made an purchase and had a reward they could have used.</p>

<p><i>Heads up: you had a reward waiting for you at Pizza Merchant that you could have used! Activate it before your next visit!</i></p>

<p><code>event: :purchase_reward_unused</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='invalid-purchase-amount'>Invalid Purchase Amount</h4>
<p>A user made a purchase that was too small to count for loyalty progress.</p>

<p><i>Your purchase came in from Pizza Merchant but it was under the minimum purchase. Make a purchase over $5 to earn loyalty progress.</i></p>

<p><code>event: :purchase_under_minimum</code></p>

<p>Additional payload keys:</p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='settlement-required'>Settlement Required</h4>
<p>A merchant&#39;s settings require a settlement to come in before the user can be granted loyalty progress.</p>

<p><i>Your Pizza Merchant purchase came through but reward progress won&#39;t apply until your credit card purchase settles. Stay tuned!</i></p>

<p><code>event: :purchase_settlement_required</code></p>

<p>Additional payload keys:</p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h4 id='tier-purchase-progress'>Tier Purchase Progress</h4>
<p>A user made a purchase that counted toward tier progress. If a merchant has both a loyalty campaign
and tiers, the loyalty progress message will be sent instead.</p>

<p><i>You&#39;re on your way! Spend $670.56 before the end of the year to earn Silver.</i></p>

<p><code>event: :purchase_tier_progress</code></p>
<h4 id='loyalty-progress'>Loyalty Progress</h4>
<p>A user made a purchase that counted toward loyalty progress.</p>

<p><i>You&#39;re almost there! You&#39;re now 45% toward your next reward at Pizza Merchant.</i></p>

<p><code>event: :purchase_loyalty_progress</code></p>

<p>Additional payload keys:</p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>
<h3 id='tiers-notifications'>Tiers notifications</h3><h4 id='on-track-to-reach-the-silver-tier'>On track to reach the silver tier</h4>
<p><i>You&#39;re on track to reach Silver for Pizza Merchant - spend $35.24 more by Dec 31st!</i></p>

<p><code>event: :tier_silver_on_track</code></p>
<h4 id='reached-the-silver-tier'>Reached the silver tier</h4>
<p><i>Silver rewards at Pizza Merchant are yours! Congrats on achieving Silver status!</i></p>

<p><code>event: :tier_silver_reached</code></p>
<h4 id='on-track-to-reach-the-gold-tier'>On track to reach the gold tier</h4>
<p><i>You&#39;re on track to reach Gold for Pizza Merchant - spend $23.45 more by Dec 31st!</i></p>

<p><code>event: :tier_gold_on_track</code></p>
<h4 id='reached-the-gold-tier'>Reached the gold tier</h4>
<p><i>Congrats on achieving Gold status at Pizza Merchant! Open up the app to see your new perks!</i></p>

<p><code>event: :tier_gold_reached</code></p>
<h4 id='tier-status-expiring-soon'>Tier status expiring soon</h4>
<p><i>Your Gold status runs out in four weeks. Spend $450.24 to keep it for another year!</i></p>

<p><code>event: :tier_status_expiring</code></p>
<h3 id='vip-notifications'>Vip notifications</h3>
<p>As users earn toward VIP status, they receive the following messages.</p>
<h4 id='vip-active'>VIP active</h4>
<p><i>You&#39;re a Pizza Merchant VIP! Open up the app to check out your VIP Reward!</i></p>

<p><code>event: :vip_active</code></p>
<h4 id='vip-at-risk'>VIP at risk</h4>
<p><i>You&#39;re almost out of time! You still need to spend $35 before Dec 1st to remain a Pizza Merchant VIP.</i></p>

<p><code>event: :vip_at_risk</code></p>
<h4 id='vip-eligible'>VIP eligible</h4>
<p><i>You&#39;re eligible for VIP this month at Pizza Merchant! Spend $50 before the end of the month to earn VIP status through Jan 1st!</i></p>

<p><code>event: :vip_eligible</code></p>
<h4 id='vip-on-track'>VIP on track</h4>
<p><i>Your spending makes you eligible to earn VIP at Pizza Merchant! Spend $50 <em>next</em> month to earn a free pizza all month!</i></p>

<p><code>event: :vip_on_track</code></p>
<h4 id='vip-nearly-there'>VIP nearly there</h4>
<p><i>You&#39;re almost a Pizza Merchant VIP! Spend $45 before Dec 1st to earn a free cactus all month!</i></p>

<p><code>event: :vip_visible</code></p>
<h3 id='reward-notifications'>Reward notifications</h3><h4 id='a-reward-is-issued'>A reward is issued</h4>
<p>This text is customizable by the merchant when they run a campaign. If customized text isn&#39;t provided, the following text is used.</p>

<p><i>You have a new reward from Pizza Merchant!</i></p>

<p><code>event: :reward_issued</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>
<h4 id='a-reward-is-expiring'>A reward is expiring</h4>
<p><i>Heads up! Your $5 off at Pizza Merchant expires on 12/15! Dont miss out!</i></p>

<p><code>event: :reward_expiring</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>
<h4 id='a-reward-was-granted'>A reward was granted</h4>
<p>The merchant issued a user a reward as a result of NPS feedback.</p>

<p><i>Pizza Merchant granted you a new reward: a free pizza!</i></p>

<p><code>event: :reward_granted</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>
<h4 id='reminder-about-an-unused-reward'>Reminder about an unused reward</h4>
<p><i>Don&#39;t forget! You have a reward ($15 off) waiting for you at Pizza Merchant!</i></p>

<p><code>event: :reward_reminder</code></p>

<p>Additional payload keys:</p>

<p><code>reward_id: &#39;ri3of2o5i46o32iu4u4k&#39;</code></p>
<h3 id='other-notifications'>Other notifications</h3><h4 id='invite-progress-earned'>Invite progress earned</h4>
<p>A user&#39;s referral made their first purchase.</p>

<p><i>Your friend Bob just made their first purchase! Here&#39;s $5 off as our way of saying thanx.</i></p>

<p><code>event: :invitation_progress_earned</code></p>
<h4 id='nps-prompt'>NPS prompt</h4>
<p><i>How was your visit to Pizza Merchant?</i></p>

<p><code>event: :purchase_nps_prompt</code></p>

<p>Additional payload keys:</p>

<p><code>purchase_id: &#39;to35yu2o4i6y34io2j24&#39;</code></p>

<p><code>feedback_id: &#39;ghjh2k34j5l23kj44566&#39;</code></p>
<h2 id='mobile-app-support'>Mobile App Support</h2><h3 id='scheme-registration-for-deep-linking'>Scheme registration for Deep Linking</h3>
<p>Thanx provides ways to deep link into your app from different parts of the platform. In order for that deep link to work and open your app, you&#39;ll have to register a specific scheme.
Contact Merchant Success or Dev Support in order to know what would be the unique scheme you&#39;ll need to use.</p>

<p>There are two main URLs that the Thanx platform will try to use in order to open your app:</p>

<p>1 - <code>SCHEME://open</code></p>

<p>2 - <code>SCHEME://magic</code></p>

<p>The first one is a generic URL used to open your app, and the second one is used during the authentication flow; alternatively, you can configure a different redirect URI and the second (authentication) URL will never be invoked. For example, if your SCHEME is <code>pizzaco</code>, then the default URLs your app needs to handle are <code>pizzaco://open</code> and <code>pizzaco://magic</code>.</p>
<h3 id='configuring-the-scheme-for-ios'>Configuring the scheme for iOS</h3>
<p>Add the following into your main <code>Info.plist</code> file:</p>
<pre class="highlight xml tab-xml"><code><span class="c">&lt;!-- Info.plist --&gt;</span>
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
...
<span class="nt">&lt;key&gt;</span>CFBundleURLTypes<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;array&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>CFBundleTypeRole<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;string&gt;</span>Editor<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;key&gt;</span>CFBundleURLName<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;string&gt;</span>Thanx<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;key&gt;</span>CFBundleURLSchemes<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;array&gt;</span>
            <span class="nt">&lt;string&gt;</span>{SCHEME}<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/array&gt;</span>
...
<span class="nt">&lt;/plist&gt;</span>
</code></pre>
<p>Where <code>{SCHEME}</code> is your own merchant scheme provided by Thanx.</p>

<p>You can find more information in the <a href="https://developer.apple.com/documentation/xcode/allowing_apps_and_websites_to_link_to_your_content/defining_a_custom_url_scheme_for_your_app">Apple documentation</a></p>
<h3 id='configuring-the-scheme-for-android'>Configuring the scheme for Android</h3>
<p>Add an <code>intent-filter</code> with the following properties for the main activity in the <code>Manifest.xml</code> file:</p>
<pre class="highlight xml tab-xml"><code><span class="c">&lt;!-- Manifest.xml --&gt;</span>
<span class="nt">&lt;activity&gt;</span>
  <span class="nt">&lt;intent-filter&gt;</span>
    <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.VIEW"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.DEFAULT"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.BROWSABLE"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">"{SCHEME}"</span> <span class="na">android:host=</span><span class="s">"magic"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">"{SCHEME}"</span> <span class="na">android:host=</span><span class="s">"open"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</code></pre>
<p>Where <code>{SCHEME}</code> is your own merchant scheme provided by Thanx.</p>

<p>You can find more information in the <a href="https://developer.android.com/training/app-links/deep-linking#adding-filters">Android Developer documentation</a></p>
<h1 id='users'>Users</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>

<p>Sandbox:
<code>
https://api.thanxsandbox.com/users
</code></p>

<p>This section describes endpoints that enable a third party to fetch a user&#39;s
profile and update aspects of that profile.</p>
<h2 id='get-user'>Get user</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/users/fkwerr <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fkwerr"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+14158672345"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"birth_date"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"year"</span><span class="p">:</span><span class="w"> </span><span class="mi">1987</span><span class="p">,</span><span class="w">
      </span><span class="s2">"month"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
      </span><span class="s2">"day"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint will return the specified user&#39;s information. <strong>Note</strong> The user&#39;s phone
number is <strong>not</strong> gathered by Thanx with the permission to use it for marketing. </p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /users/:id</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The user&#39;s identifier</td>
</tr>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>phone</code></td>
<td>string</td>
<td>The user&#39;s phone number, formatted: +14157582345</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>The user&#39;s first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>The user&#39;s last name</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>hash</td>
<td>The user&#39;s birthday information</td>
</tr>
<tr>
<td><code>birth_date.year</code></td>
<td>integer</td>
<td>The user&#39;s birth year</td>
</tr>
<tr>
<td><code>birth_date.month</code></td>
<td>integer</td>
<td>The user&#39;s birth month</td>
</tr>
<tr>
<td><code>birth_date.day</code></td>
<td>integer</td>
<td>The user&#39;s birth day</td>
</tr>
<tr>
<td><code>gender</code></td>
<td>enum</td>
<td>The user&#39;s gender (<code>male</code>, <code>female</code>, <code>other</code>, <code>unknown</code>)</td>
</tr>
</tbody></table>
<h2 id='create-user'>Create user</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/users/ <span class="se">\</span>
  -X POST <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
  -d <span class="s1">'{
    "user": {
      "email": "jane.smith@example.com",
      "phone": "+14158672345",
      "first_name": "Jane",
      "last_name":  "Smith",
      "birth_date": {
        "year": 1987,
        "month": 8,
        "day": 14
      },
      "gender": "other"
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (201 CREATED)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wroeiu2304hfwf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane.smith@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+14158672345"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"birth_date"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"year"</span><span class="p">:</span><span class="w"> </span><span class="mi">1987</span><span class="p">,</span><span class="w">
      </span><span class="s2">"month"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
      </span><span class="s2">"day"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"other"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"authorization"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passwordless"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1577836800</span><span class="p">,</span><span class="w">
    </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c74334301a7c74d21b714c905fd3047177dab56de6a86899e6f6b7f71bab7d55"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint creates a user. If a user with the specified email already exists a 400 level error
will be returned. This endpoint also returns authorization information for a successfully created user. The access_token that is returned can be used to access other API endpoints.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /users</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>phone</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s phone number, formatted: +14157582345</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s last name</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>hash</td>
<td>Optional</td>
<td>The user&#39;s birthday information</td>
</tr>
<tr>
<td><code>birth_date.year</code></td>
<td>integer</td>
<td>Optional</td>
<td>The user&#39;s birth year</td>
</tr>
<tr>
<td><code>birth_date.month</code></td>
<td>integer</td>
<td>Optional</td>
<td>The user&#39;s birth month</td>
</tr>
<tr>
<td><code>birth_date.day</code></td>
<td>integer</td>
<td>Optional</td>
<td>The user&#39;s birth day</td>
</tr>
<tr>
<td><code>gender</code></td>
<td>enum</td>
<td>Optional</td>
<td>The user&#39;s gender (<code>male</code>, <code>female</code>, <code>other</code>, <code>unknown</code>)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>user.id</code></td>
<td>string</td>
<td>The user&#39;s identifier</td>
</tr>
<tr>
<td><code>user.email</code></td>
<td>string</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>user.phone</code></td>
<td>string</td>
<td>The user&#39;s phone number, formatted: +14157582345</td>
</tr>
<tr>
<td><code>user.first_name</code></td>
<td>string</td>
<td>The user&#39;s first name</td>
</tr>
<tr>
<td><code>user.last_name</code></td>
<td>string</td>
<td>The user&#39;s last name</td>
</tr>
<tr>
<td><code>user.birth_date</code></td>
<td>hash</td>
<td>The user&#39;s birthday information</td>
</tr>
<tr>
<td><code>user.birth_date.year</code></td>
<td>integer</td>
<td>The user&#39;s birth year</td>
</tr>
<tr>
<td><code>user.birth_date.month</code></td>
<td>integer</td>
<td>The user&#39;s birth month</td>
</tr>
<tr>
<td><code>user.birth_date.day</code></td>
<td>integer</td>
<td>The user&#39;s birth day</td>
</tr>
<tr>
<td><code>user.gender</code></td>
<td>enum</td>
<td>The user&#39;s gender (<code>male</code>, <code>female</code>, <code>other</code>, <code>unknown</code>)</td>
</tr>
<tr>
<td><code>authorization.token_type</code></td>
<td>string</td>
<td>The type of token, usually &quot;Bearer&quot;</td>
</tr>
<tr>
<td><code>authorization.scope</code></td>
<td>string</td>
<td>This will be &#39;passwordless&#39;</td>
</tr>
<tr>
<td><code>authorization.created_at</code></td>
<td>integer</td>
<td>The number of seconds since the epoch</td>
</tr>
<tr>
<td><code>authorization.access_token</code></td>
<td>string</td>
<td>The user&#39;s access token, for use in accessing other API endpoints</td>
</tr>
<tr>
<td><code>authorization.refresh_token</code></td>
<td>string</td>
<td>If needed, a refresh token to get another access token</td>
</tr>
</tbody></table>
<h2 id='update-user'>Update user</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/users/werljwer <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
  -d <span class="s1">'{
    "user": {
      "email": "jane.smith@example.com",
      "first_name": "Jane"
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+14158672345"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"birth_date"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"year"</span><span class="p">:</span><span class="w"> </span><span class="mi">1987</span><span class="p">,</span><span class="w">
      </span><span class="s2">"month"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
      </span><span class="s2">"day"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint updates the specified user&#39;s information. <strong>Note</strong> The user&#39;s phone
number is <strong>not</strong> gathered by Thanx with the permission to use it for marketing. </p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /users/:id</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>phone</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s phone number, formatted: +14157582345</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s last name</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>hash</td>
<td>Optional</td>
<td>The user&#39;s birthday information</td>
</tr>
<tr>
<td><code>birth_date.year</code></td>
<td>integer</td>
<td>Optional</td>
<td>The user&#39;s birth year</td>
</tr>
<tr>
<td><code>birth_date.month</code></td>
<td>integer</td>
<td>Optional</td>
<td>The user&#39;s birth month</td>
</tr>
<tr>
<td><code>birth_date.day</code></td>
<td>integer</td>
<td>Optional</td>
<td>The user&#39;s birth day</td>
</tr>
<tr>
<td><code>gender</code></td>
<td>enum</td>
<td>Optional</td>
<td>The user&#39;s gender (<code>male</code>, <code>female</code>, <code>other</code>, <code>unknown</code>)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The user&#39;s identifier</td>
</tr>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>phone</code></td>
<td>string</td>
<td>The user&#39;s phone number, formatted: +14157582345</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>The user&#39;s first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>The user&#39;s last name</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>hash</td>
<td>The user&#39;s birthday information</td>
</tr>
<tr>
<td><code>birth_date.year</code></td>
<td>integer</td>
<td>The user&#39;s birth year</td>
</tr>
<tr>
<td><code>birth_date.month</code></td>
<td>integer</td>
<td>The user&#39;s birth month</td>
</tr>
<tr>
<td><code>birth_date.day</code></td>
<td>integer</td>
<td>The user&#39;s birth day</td>
</tr>
<tr>
<td><code>gender</code></td>
<td>enum</td>
<td>The user&#39;s gender (<code>male</code>, <code>female</code>, <code>other</code>, <code>unknown</code>)</td>
</tr>
</tbody></table>
<h1 id='sso'>SSO</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.thanxsandbox.com/oauth
</code></pre>
<p>This section describes the process of authenticating with Thanx via Thanx
SSO. Thanx SSO authenticates the user via a password-less flow using email
authentication, rather than a password. This reduces the friction of a user
having to manage yet another password as well as reduces the friction of
transitioning an existing user-base to Thanx.</p>

<p>Thanx follows the standard OAuth 2.0 spec, using the Authorization Code grant
type. Refer to the
<a href="https://tools.ietf.org/html/rfc6749#section-4.1">OAuth 2.0 Authorization Framework RFC: Section 4.1</a>
for additional details.</p>

<p>Here is what the flow would look like:</p>

<ol>
<li>User navigates to the merchant website and clicks an authentication button.</li>
<li>The merchant website prompts the user to input an email address</li>
<li>The merchant website makes a request to the <code>POST /oauth/authorize</code> endpoint
described below. <em>(Continue to #4 or #5)</em></li>
<li>If no account exists for the specified email address, a 401 error is thrown.</li>
<li>If an account exists for the specified email address, an auth email is sent
to specified email. The user clicks the auth email link which redirects to the
merchant website at the specified <code>redirect_uri</code> with an authorization code in
the params.</li>
<li>Merchant website exchanges the authorization code for an access token via
the <code>POST /oauth/token</code> endpoint described below. User is now authenticated
with the Thanx system through the returned access token.</li>
</ol>
<h3 id='legal-requirements'>Legal Requirements</h3>
<p>The following notice with links to the Thanx Privacy Policy and Terms
of Service must be displayed in the user experience where a user signs up.</p>

<p><strong>By signing up you agree to our
<a href="https://app.thanx.com/privacy">privacy policy</a>
and our <a href="https://app.thanx.com/terms">terms of service</a></strong></p>
<h2 id='acquire-authorization-code'>Acquire authorization code</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/oauth/authorize <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "client_id": "f4bf04a6fc27b5fa926a7318933b76440642c25cde037d8e867b3d18d771ad86",
    "redirect_uri": "https://www.example.com/oauth/callback",
    "response_type": "code",
    "scope": "passwordless",
    "username": "john.smith@example.com"
  }'</span>
</code></pre>
<blockquote>
<p>Response (201 Created)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c13a4ba07f27cfc69a03a5c9cda630205e5f2833331fb761d38eef10c091f371"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This flow is to support passwordless login.</p>

<p>If an account exists, an authentication email will be sent including a link that will eventually redirect to the redirect_uri with an authorization code.</p>

<p>If an account does not exist for the specified email, a 401 error will be returned.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /oauth/authorize</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>client_id</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client ID</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>string</td>
<td>Required</td>
<td>Where you want the user to be redirected</td>
</tr>
<tr>
<td><code>response_type</code></td>
<td>string</td>
<td>Required</td>
<td><code>code</code> is the required value</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>string</td>
<td>Required</td>
<td><code>passwordless</code> is the required value</td>
</tr>
<tr>
<td><code>username</code></td>
<td>string</td>
<td>Required</td>
<td>The user&#39;s email</td>
</tr>
</tbody></table>
<h2 id='acquire-access-token'>Acquire access token</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/oauth/token <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
  {
    "grant_type": "authorization_code",
    "client_id": "f4bf04a6fc27b5fa926a7318933b76440642c25cde037d8e867b3d18d771ad86",
    "client_secret": "83c08861ce6302e0e73d28cea30aa3f8f3ea98446e133fde60a86231f50f5c82",
    "code": "c13a4ba07f27cfc69a03a5c9cda630205e5f2833331fb761d38eef10c091f371",
    "redirect_uri": "https://www.example.com/oauth/callback"
  }
</span></code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passwordless"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1577836800</span><span class="p">,</span><span class="w">
    </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c74334301a7c74d21b714c905fd3047177dab56de6a86899e6f6b7f71bab7d55"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Use this endpoint to acquire a user&#39;s access token. This same endpoint supports refreshing an access token using the client_id, client_secret, and refresh_token, with grant_type set to <code>refresh_token</code>.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /oauth/token</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>grant_type</code></td>
<td>string</td>
<td>Required</td>
<td><code>authorization_code</code> is the required value</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client Secret</td>
</tr>
<tr>
<td><code>code</code></td>
<td>string</td>
<td>Required</td>
<td>The authorization code received from Thanx via redirect or API</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>string</td>
<td>Required</td>
<td>The same redirect_uri should be used as in the request for the authorization code</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>token_type</code></td>
<td>string</td>
<td>The type of token, usually &quot;Bearer&quot;</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>string</td>
<td>This will be &#39;passwordless&#39;</td>
</tr>
<tr>
<td><code>created_at</code></td>
<td>integer</td>
<td>The number of seconds since the epoch</td>
</tr>
<tr>
<td><code>access_token</code></td>
<td>string</td>
<td>The user&#39;s access token, for use in accessing other API endpoints</td>
</tr>
<tr>
<td><code>refresh_token</code></td>
<td>string</td>
<td>If needed, a refresh token to get another access token</td>
</tr>
</tbody></table>
<h2 id='revoke-access-token'>Revoke Access Token</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/oauth/revoke <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "client_id": "f4bf04a6fc27b5fa926a7318933b76440642c25cde037d8e867b3d18d771ad86",
    "client_secret": "83c08861ce6302e0e73d28cea30aa3f8f3ea98446e133fde60a86231f50f5c82",
    "token": "945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>Use this endpoint to revoke a user&#39;s access token.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /oauth/revoke</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>client_id</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client Secret</td>
</tr>
<tr>
<td><code>token</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Access Token</td>
</tr>
</tbody></table>
<h1 id='features'>Features</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>

<p>Sandbox:
<code>
https://api.thanxsandbox.com/features
</code></p>

<p>This section describes endpoints that enable a third party to fetch features that
are configured for a given merchant. These features include and are not limited to
the requirements to earn and redeem a loyalty reward, the birthday reward, and the introductory reward.</p>
<h2 id='get-features'>Get Features</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/features <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"features"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wourhfslur"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"loyalty"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spend $150"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spend"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$10 off"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"intro"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sign up"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"free sandwich"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"online"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"birthday"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"provide your birthday"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"automatic"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10% off"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"instore"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns the configuration for a merchant&#39;s features. If a merchant
does not have a particular feature defined or enabled, the value for the associated
feature key will be empty.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /features</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return features for this merchant if you have access to multiple merchants</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>The merchant ID</td>
</tr>
<tr>
<td><code>loyalty</code></td>
<td>hash</td>
<td>Describes the configuration for the loyalty campaign</td>
</tr>
<tr>
<td><code>loyalty.earn</code></td>
<td>hash</td>
<td>Describes how the loyalty reward is earned</td>
</tr>
<tr>
<td><code>loyalty.earn.description</code></td>
<td>string</td>
<td>What the user should do to earn the reward</td>
</tr>
<tr>
<td><code>loyalty.earn.type</code></td>
<td>enum</td>
<td>Whether the user earns progress via how much they spend or how many times they visit. Returns &#39;spend&#39; or &#39;visit&#39;.</td>
</tr>
<tr>
<td><code>loyalty.earn.threshold</code></td>
<td>integer</td>
<td>How much the user needs to spend or how many visits the user needs to make to earn the reward.</td>
</tr>
<tr>
<td><code>loyalty.redeem</code></td>
<td>hash</td>
<td>Describes what the reward is</td>
</tr>
<tr>
<td><code>loyalty.redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>loyalty.redeem.text</code></td>
<td>string</td>
<td>Description of what the loyalty reward is</td>
</tr>
<tr>
<td><code>loyalty.redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
<tr>
<td><code>intro</code></td>
<td>hash</td>
<td>Describes the configuration for the introductory campaign</td>
</tr>
<tr>
<td><code>intro.earn</code></td>
<td>hash</td>
<td>Describes how the introductory reward is earned</td>
</tr>
<tr>
<td><code>intro.earn.description</code></td>
<td>string</td>
<td>What the user should do to earn the reward</td>
</tr>
<tr>
<td><code>intro.redeem</code></td>
<td>hash</td>
<td>Describes what the reward is</td>
</tr>
<tr>
<td><code>intro.redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>intro.redeem.text</code></td>
<td>string</td>
<td>Description of what the introductory reward is</td>
</tr>
<tr>
<td><code>intro.redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
<tr>
<td><code>birthday</code></td>
<td>hash</td>
<td>Describes the configuration for the birthday campaign</td>
</tr>
<tr>
<td><code>birthday.earn</code></td>
<td>hash</td>
<td>Describes how the birthday reward is earned</td>
</tr>
<tr>
<td><code>birthday.earn.description</code></td>
<td>string</td>
<td>What the user should do to earn the reward</td>
</tr>
<tr>
<td><code>birthday.redeem</code></td>
<td>hash</td>
<td>Describes what the reward is</td>
</tr>
<tr>
<td><code>birthday.redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>birthday.redeem.text</code></td>
<td>string</td>
<td>Description of what the birthday reward is</td>
</tr>
<tr>
<td><code>birthday.redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
</tbody></table>
<h1 id='cards'>Cards</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.thanxsandbox.com/cards
</code></pre>
<p>This section describes endpoints that enable a third party to fetch and register
a user&#39;s cards.</p>
<h2 id='describe-cards'>Describe Cards</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/cards <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"cards"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weorusfs"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"visa"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wer340fweiu"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weorufjsdf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4567"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amex"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes all registered cards for the given user.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /cards</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Card ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>The user the card belongs to</td>
</tr>
<tr>
<td><code>last4</code></td>
<td>string</td>
<td>Last 4 digits of the card PAN</td>
</tr>
<tr>
<td><code>type</code></td>
<td>enum</td>
<td>Card type (<code>visa</code>, <code>mastercard</code>, <code>amex</code>)</td>
</tr>
</tbody></table>
<h2 id='get-signature'>Get Signature</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/card_signature?card_type<span class="o">=</span>amex <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"card_signature"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"amex"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"public_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sfjwoiruweoirw20394jf09wr80294"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint provides a way to retrieve a signature for card encryption. The public key
and certificate returned can be used with the card encryption SDK.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /card_signature</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>card_type</code></td>
<td>string</td>
<td>Required</td>
<td>Card type (<code>visa</code>, <code>mastercard</code>, <code>amex</code>)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>visa</code></td>
<td>hash</td>
<td>Signature information for Visa</td>
</tr>
<tr>
<td><code>visa.public_key</code></td>
<td>The public key to use for encryption.</td>
<td></td>
</tr>
<tr>
<td><code>mastercard</code></td>
<td>hash</td>
<td>Signature information for Mastercard</td>
</tr>
<tr>
<td><code>mastercard.public_key</code></td>
<td>The public key to use for encryption.</td>
<td></td>
</tr>
<tr>
<td><code>amex</code></td>
<td>hash</td>
<td>Signature information for American Express</td>
</tr>
<tr>
<td><code>amex.public_key</code></td>
<td>The public key to use for encryption.</td>
<td></td>
</tr>
</tbody></table>
<h2 id='create-card'>Create Card</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/cards <span class="se">\</span>
  -X POST <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
  -d <span class="s1">'{
    "card": {
      "last4": "1234",
      "type": "visa",
      "encrypted_pan" "..."
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (201 CREATED)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weorufsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"visa"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint registers a new card with Thanx.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /cards</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>last4</code></td>
<td>string</td>
<td>Required</td>
<td>Last 4 digits of the card PAN</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>Required</td>
<td>Card type (<code>visa</code>, <code>mastercard</code>, <code>amex</code>)</td>
</tr>
<tr>
<td><code>encrypted_pan</code></td>
<td>string</td>
<td>Required</td>
<td>Encrypted Card PAN (<strong>Must use Thanx Tokenization SDK for this. No raw PANs should ever be sent to Thanx APIs</strong>)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Card ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>The user the card belongs to</td>
</tr>
<tr>
<td><code>last4</code></td>
<td>string</td>
<td>Last 4 digits of the card PAN</td>
</tr>
<tr>
<td><code>type</code></td>
<td>enum</td>
<td>Card type (<code>visa</code>, <code>mastercard</code>, <code>amex</code>)</td>
</tr>
</tbody></table>
<h2 id='delete-card'>Delete Card</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/cards/92b7b0dac4 <span class="se">\</span>
  -X DELETE <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (204 NO_CONTENT)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>This endpoint archives a registered card. The card is unenrolled from Visa/Mastercard/Amex.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>DELETE /cards/:id</code></p>
<h1 id='rewards'>Rewards</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>

<p>Sandbox:
<code>
https://api.thanxsandbox.com/rewards
</code></p>

<p>This section describes endpoints that enable a third party to fetch a user&#39;s
rewards and activate (use) them on behalf of the user.</p>
<h2 id='describe-rewards'>Describe Rewards</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/rewards <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"rewards"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"222441e34626"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werofsdf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weroif"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"85133c3c1258"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"available"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"intro"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signing up"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$10 off"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"window"</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w">
        </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"coupon_code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"fine_print"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Can't be used for alcohol purchases"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"instructions"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example staff instructions"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"available_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-25T19:00:00Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"activated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"retire_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"used_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns a user&#39;s rewards. Rewards are available in several
different states:
- <code>available</code> =&gt; This reward is available to use
- <code>active</code> =&gt; The user has activated this reward for use
- <code>used</code> =&gt; The reward has been used</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /rewards</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>states</code></td>
<td>array[string]</td>
<td>Optional</td>
<td>Only rewards in these states will be returned. Valid options are: (<code>available</code>, <code>active</code>, <code>used</code>). The default is to return all rewards in these 3 states.</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return rewards for this merchant</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return rewards for this user. Note: the bearer token will be used to determine which user&#39;s rewards are being requested when the request is made by a logged in user.</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Reward ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>campaign_id</code></td>
<td>string</td>
<td>Campaign ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>Reward State (<code>available</code>, <code>active</code>, <code>used</code>)</td>
</tr>
<tr>
<td><code>fine_print</code></td>
<td>string</td>
<td>Fine print for the reward</td>
</tr>
<tr>
<td><code>instructions</code></td>
<td>string</td>
<td>Staff instructions for the reward</td>
</tr>
<tr>
<td><code>available_at</code></td>
<td>string</td>
<td>Time the reward was given to the user in ISO8601-format</td>
</tr>
<tr>
<td><code>activated_at</code></td>
<td>string</td>
<td>Time the reward was activated in ISO8601-format</td>
</tr>
<tr>
<td><code>used_at</code></td>
<td>string</td>
<td>Time the reward was marked as used in ISO8601-format</td>
</tr>
<tr>
<td><code>retire_at</code></td>
<td>string</td>
<td>Time the reward will be automatically retired in ISO8601-format</td>
</tr>
<tr>
<td><code>coupon_code</code></td>
<td>hash</td>
<td>This hash will be populated if the reward is &#39;active&#39; or &#39;used&#39; and the merchant uses coupon codes.</td>
</tr>
<tr>
<td><code>coupon_code.code</code></td>
<td>string</td>
<td>The raw coupon code value that should be rendered based on the <code>coupon_code_type</code> enum</td>
</tr>
<tr>
<td><code>coupon_code.type</code></td>
<td>enum</td>
<td>The type of coupon code that should be used to render the <code>coupon_code</code> value (<code>raw</code>, <code>qrcode</code>, <code>barcode39</code>, <code>barcode39extended</code>, <code>barcode93</code>, <code>barcode128</code>, <code>barcode_upc_a</code>, <code>barcode_ean_8</code>, <code>barcode_ean_13</code>, <code>barcode25interleaved</code>)</td>
</tr>
<tr>
<td><code>coupon_code.display</code></td>
<td>string</td>
<td>If set, should be displayed instead of the raw coupon code value</td>
</tr>
<tr>
<td><code>earn</code></td>
<td>hash</td>
<td>Details of how the reward was earned</td>
</tr>
<tr>
<td><code>earn.type</code></td>
<td>enum</td>
<td>Type of program the reward was earned with</td>
</tr>
<tr>
<td><code>earn.text</code></td>
<td>string</td>
<td>Description of how the reward was earned</td>
</tr>
<tr>
<td><code>redeem</code></td>
<td>hash</td>
<td>Details of how the reward can be redeemed</td>
</tr>
<tr>
<td><code>redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>redeem.text</code></td>
<td>string</td>
<td>Description of what the reward is</td>
</tr>
<tr>
<td><code>redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
<tr>
<td><code>redeem.window</code></td>
<td>integer</td>
<td>Number of minutes the reward is available for use after activation</td>
</tr>
</tbody></table>
<h2 id='get-single-reward'>Get Single Reward</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/rewards/222441e34626 <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"reward"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"222441e34626"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werofsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weroif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"85133c3c1258"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"available"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"intro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signing up"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$10 off"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"window"</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w">
      </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"coupon_code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"fine_print"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Can't be used for alcohol purchases"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"instructions"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example staff instructions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"available_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-25T19:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"activated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retire_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"used_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns the reward corresponding to the ID in the path.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /rewards/:reward_id</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Reward ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>campaign_id</code></td>
<td>string</td>
<td>Campaign ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>Reward State (<code>available</code>, <code>active</code>, <code>used</code>)</td>
</tr>
<tr>
<td><code>fine_print</code></td>
<td>string</td>
<td>Fine print for the reward</td>
</tr>
<tr>
<td><code>instructions</code></td>
<td>string</td>
<td>Staff instructions for the reward</td>
</tr>
<tr>
<td><code>available_at</code></td>
<td>string</td>
<td>Time the reward was given to the user in ISO8601-format</td>
</tr>
<tr>
<td><code>activated_at</code></td>
<td>string</td>
<td>Time the reward was activated in ISO8601-format</td>
</tr>
<tr>
<td><code>used_at</code></td>
<td>string</td>
<td>Time the reward was marked as used in ISO8601-format</td>
</tr>
<tr>
<td><code>retire_at</code></td>
<td>string</td>
<td>Time the reward will be automatically retired in ISO8601-format</td>
</tr>
<tr>
<td><code>coupon_code</code></td>
<td>hash</td>
<td>This hash will be populated if the reward is &#39;active&#39; or &#39;used&#39; and the merchant uses coupon codes.</td>
</tr>
<tr>
<td><code>coupon_code.code</code></td>
<td>string</td>
<td>The raw coupon code value that should be rendered based on the <code>coupon_code_type</code> enum</td>
</tr>
<tr>
<td><code>coupon_code.type</code></td>
<td>enum</td>
<td>The type of coupon code that should be used to render the <code>coupon_code</code> value (<code>raw</code>, <code>qrcode</code>, <code>barcode39</code>, <code>barcode39extended</code>, <code>barcode93</code>, <code>barcode128</code>, <code>barcode_upc_a</code>, <code>barcode_ean_8</code>, <code>barcode_ean_13</code>, <code>barcode25interleaved</code>)</td>
</tr>
<tr>
<td><code>coupon_code.display</code></td>
<td>string</td>
<td>If set, should be displayed instead of the raw coupon code value</td>
</tr>
<tr>
<td><code>earn</code></td>
<td>hash</td>
<td>Details of how the reward was earned</td>
</tr>
<tr>
<td><code>earn.type</code></td>
<td>enum</td>
<td>Type of program the reward was earned with</td>
</tr>
<tr>
<td><code>earn.text</code></td>
<td>string</td>
<td>Description of how the reward was earned</td>
</tr>
<tr>
<td><code>redeem</code></td>
<td>hash</td>
<td>Details of how the reward can be redeemed</td>
</tr>
<tr>
<td><code>redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>redeem.text</code></td>
<td>string</td>
<td>Description of what the reward is</td>
</tr>
<tr>
<td><code>redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
<tr>
<td><code>redeem.window</code></td>
<td>integer</td>
<td>Number of minutes the reward is available for use after activation</td>
</tr>
</tbody></table>
<h2 id='activate-reward'>Activate Reward</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/users/roiwe/rewards/222441e34626/activate <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"reward"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"222441e34626"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werofsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weroif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"85133c3c1258"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"intro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signing up"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$10 off"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"window"</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w">
      </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"coupon_code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"fine_print"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Can't be used for alcohol purchases"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"instructions"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example staff instructions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"available_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-25T19:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"activated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retire_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"used_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint activates the reward, transitioning reward state from <code>available</code>
to <code>active</code>.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /rewards/:reward_id/activate</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Reward ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>campaign_id</code></td>
<td>string</td>
<td>Campaign ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>Reward State (<code>available</code>, <code>active</code>, <code>used</code>)</td>
</tr>
<tr>
<td><code>fine_print</code></td>
<td>string</td>
<td>Fine print for the reward</td>
</tr>
<tr>
<td><code>instructions</code></td>
<td>string</td>
<td>Staff instructions for the reward</td>
</tr>
<tr>
<td><code>available_at</code></td>
<td>string</td>
<td>Time the reward was given to the user in ISO8601-format</td>
</tr>
<tr>
<td><code>activated_at</code></td>
<td>string</td>
<td>Time the reward was activated in ISO8601-format</td>
</tr>
<tr>
<td><code>used_at</code></td>
<td>string</td>
<td>Time the reward was marked as used in ISO8601-format</td>
</tr>
<tr>
<td><code>retire_at</code></td>
<td>string</td>
<td>Time the reward will be automatically retired in ISO8601-format</td>
</tr>
<tr>
<td><code>coupon_code</code></td>
<td>hash</td>
<td>This hash will be populated if the reward is &#39;active&#39; or &#39;used&#39; and the merchant uses coupon codes.</td>
</tr>
<tr>
<td><code>coupon_code.code</code></td>
<td>string</td>
<td>The raw coupon code value that should be rendered based on the <code>coupon_code_type</code> enum</td>
</tr>
<tr>
<td><code>coupon_code.type</code></td>
<td>enum</td>
<td>The type of coupon code that should be used to render the <code>coupon_code</code> value (<code>raw</code>, <code>qrcode</code>, <code>barcode39</code>, <code>barcode39extended</code>, <code>barcode93</code>, <code>barcode128</code>, <code>barcode_upc_a</code>, <code>barcode_ean_8</code>, <code>barcode_ean_13</code>, <code>barcode25interleaved</code>)</td>
</tr>
<tr>
<td><code>coupon_code.display</code></td>
<td>string</td>
<td>If set, should be displayed instead of the raw coupon code value</td>
</tr>
<tr>
<td><code>earn</code></td>
<td>hash</td>
<td>Details of how the reward was earned</td>
</tr>
<tr>
<td><code>earn.type</code></td>
<td>enum</td>
<td>Type of program the reward was earned with</td>
</tr>
<tr>
<td><code>earn.text</code></td>
<td>string</td>
<td>Description of how the reward was earned</td>
</tr>
<tr>
<td><code>redeem</code></td>
<td>hash</td>
<td>Details of how the reward can be redeemed</td>
</tr>
<tr>
<td><code>redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>redeem.text</code></td>
<td>string</td>
<td>Description of what the reward is</td>
</tr>
<tr>
<td><code>redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
<tr>
<td><code>redeem.window</code></td>
<td>integer</td>
<td>Number of minutes the reward is available for use after activation</td>
</tr>
</tbody></table>
<h2 id='finalize-reward'>Finalize Reward</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/rewards/222441e34626/finalize <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"reward"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"222441e34626"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werofsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weroif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"85133c3c1258"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"used"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"intro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signing up"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$10 off"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"window"</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w">
      </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"coupon_code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"fine_print"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Can't be used for alcohol purchases"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"instructions"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example staff instructions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"available_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-25T19:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"activated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retire_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"used_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint marks the reward as used, transitioning reward state to <code>used</code>.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /rewards/:reward_id/finalize</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Reward ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>campaign_id</code></td>
<td>string</td>
<td>Campaign ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>Reward State (<code>available</code>, <code>active</code>, <code>used</code>)</td>
</tr>
<tr>
<td><code>fine_print</code></td>
<td>string</td>
<td>Fine print for the reward</td>
</tr>
<tr>
<td><code>instructions</code></td>
<td>string</td>
<td>Staff instructions for the reward</td>
</tr>
<tr>
<td><code>available_at</code></td>
<td>string</td>
<td>Time the reward was given to the user in ISO8601-format</td>
</tr>
<tr>
<td><code>activated_at</code></td>
<td>string</td>
<td>Time the reward was activated in ISO8601-format</td>
</tr>
<tr>
<td><code>used_at</code></td>
<td>string</td>
<td>Time the reward was marked as used in ISO8601-format</td>
</tr>
<tr>
<td><code>retire_at</code></td>
<td>string</td>
<td>Time the reward will be automatically retired in ISO8601-format</td>
</tr>
<tr>
<td><code>coupon_code</code></td>
<td>hash</td>
<td>This hash will be populated if the reward is &#39;active&#39; or &#39;used&#39; and the merchant uses coupon codes.</td>
</tr>
<tr>
<td><code>coupon_code.code</code></td>
<td>string</td>
<td>The raw coupon code value that should be rendered based on the <code>coupon_code_type</code> enum</td>
</tr>
<tr>
<td><code>coupon_code.type</code></td>
<td>enum</td>
<td>The type of coupon code that should be used to render the <code>coupon_code</code> value (<code>raw</code>, <code>qrcode</code>, <code>barcode39</code>, <code>barcode39extended</code>, <code>barcode93</code>, <code>barcode128</code>, <code>barcode_upc_a</code>, <code>barcode_ean_8</code>, <code>barcode_ean_13</code>, <code>barcode25interleaved</code>)</td>
</tr>
<tr>
<td><code>coupon_code.display</code></td>
<td>string</td>
<td>If set, should be displayed instead of the raw coupon code value</td>
</tr>
<tr>
<td><code>earn</code></td>
<td>hash</td>
<td>Details of how the reward was earned</td>
</tr>
<tr>
<td><code>earn.type</code></td>
<td>enum</td>
<td>Type of program the reward was earned with</td>
</tr>
<tr>
<td><code>earn.text</code></td>
<td>string</td>
<td>Description of how the reward was earned</td>
</tr>
<tr>
<td><code>redeem</code></td>
<td>hash</td>
<td>Details of how the reward can be redeemed</td>
</tr>
<tr>
<td><code>redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>redeem.text</code></td>
<td>string</td>
<td>Description of what the reward is</td>
</tr>
<tr>
<td><code>redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
<tr>
<td><code>redeem.window</code></td>
<td>integer</td>
<td>Number of minutes the reward is available for use after activation</td>
</tr>
</tbody></table>
<h2 id='grant-reward'>Grant Reward</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/rewards/grant <span class="se">\</span>
  -X POST <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
  -d <span class="s1">'{
    "user_id": "weoru",
    "campaign_id": "weroui234890f"
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"reward"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"222441e34626"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werofsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weroif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"85133c3c1258"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"earn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"intro"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signing up"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$10 off"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"window"</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w">
      </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"coupon_code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"fine_print"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Can't be used for alcohol purchases"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"instructions"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example staff instructions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"available_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-25T19:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"activated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retire_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"used_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint grants the user a reward associated with the campaign provided.
<strong>This endpoint is only available in SANDBOX</strong></p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /rewards/grant</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>campaign_id</code></td>
<td>string</td>
<td>Required</td>
<td>The campaign id to grant the reward for</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>Required</td>
<td>The user to grant the reward for</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Reward ID</td>
</tr>
<tr>
<td><code>campaign_id</code></td>
<td>string</td>
<td>Campaign ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>Reward State (<code>available</code>, <code>active</code>, <code>used</code>)</td>
</tr>
<tr>
<td><code>fine_print</code></td>
<td>string</td>
<td>Fine print for the reward</td>
</tr>
<tr>
<td><code>instructions</code></td>
<td>string</td>
<td>Staff instructions for the reward</td>
</tr>
<tr>
<td><code>available_at</code></td>
<td>string</td>
<td>Time the reward was given to the user in ISO8601-format</td>
</tr>
<tr>
<td><code>activated_at</code></td>
<td>string</td>
<td>Time the reward was activated in ISO8601-format</td>
</tr>
<tr>
<td><code>used_at</code></td>
<td>string</td>
<td>Time the reward was marked as used in ISO8601-format</td>
</tr>
<tr>
<td><code>retire_at</code></td>
<td>string</td>
<td>Time the reward will be automatically retired in ISO8601-format</td>
</tr>
<tr>
<td><code>coupon_code</code></td>
<td>hash</td>
<td>This hash will be populated if the reward is &#39;active&#39; or &#39;used&#39; and the merchant uses coupon codes.</td>
</tr>
<tr>
<td><code>coupon_code.code</code></td>
<td>string</td>
<td>The raw coupon code value that should be rendered based on the <code>coupon_code_type</code> enum</td>
</tr>
<tr>
<td><code>coupon_code.type</code></td>
<td>enum</td>
<td>The type of coupon code that should be used to render the <code>coupon_code</code> value (<code>raw</code>, <code>qrcode</code>, <code>barcode39</code>, <code>barcode39extended</code>, <code>barcode93</code>, <code>barcode128</code>, <code>barcode_upc_a</code>, <code>barcode_ean_8</code>, <code>barcode_ean_13</code>, <code>barcode25interleaved</code>)</td>
</tr>
<tr>
<td><code>coupon_code.display</code></td>
<td>string</td>
<td>If set, should be displayed instead of the raw coupon code value</td>
</tr>
<tr>
<td><code>earn</code></td>
<td>hash</td>
<td>Details of how the reward was earned</td>
</tr>
<tr>
<td><code>earn.type</code></td>
<td>enum</td>
<td>Type of program the reward was earned with</td>
</tr>
<tr>
<td><code>earn.text</code></td>
<td>string</td>
<td>Description of how the reward was earned</td>
</tr>
<tr>
<td><code>redeem</code></td>
<td>hash</td>
<td>Details of how the reward can be redeemed</td>
</tr>
<tr>
<td><code>redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>redeem.text</code></td>
<td>string</td>
<td>Description of what the reward is</td>
</tr>
<tr>
<td><code>redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
<tr>
<td><code>redeem.window</code></td>
<td>integer</td>
<td>Number of minutes the reward is available for use after activation</td>
</tr>
</tbody></table>
<h1 id='tags'>Tags</h1>
<blockquote>
<p>API Endpoint
Sandbox:
<code>
https://api.thanxsandbox.com/tags
</code></p>
</blockquote>

<p>This section describes endpoints that enable a third party to fetch and update
a user&#39;s tags.</p>
<h2 id='describe-tags'>Describe Tags</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/tags <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werofsdf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weroif"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allergens"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"gluten"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"soy"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dairy"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes all attribute tags for the given user.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /tags</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return tags for this merchant</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Tag ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>key</code></td>
<td>string</td>
<td>Tag key</td>
</tr>
<tr>
<td><code>values</code></td>
<td>array(string)</td>
<td>Array of attribute tags</td>
</tr>
</tbody></table>
<h2 id='update-tags'>Update Tags</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/tags <span class="se">\</span>
  -X PUT <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
  -d <span class="s1">'{
    "tag": {
      "key": "allergens",
      "merchant_id": "weroifs",
      "values": [
        "gluten",
        "soy",
        "dairy",
        "honey"
      ]
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"tag"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werwerr"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werofsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weroif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"allergens"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"gluten"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"soy"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dairy"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"honey"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint updates an attribute tag for the given user. The tag associated with
the key in the request will be created or updated with the values passed in.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PUT /tags</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Required</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>key</code></td>
<td>string</td>
<td>Required</td>
<td>Tag key</td>
</tr>
<tr>
<td><code>values</code></td>
<td>array(string)</td>
<td>Required</td>
<td>Array of attributes tags</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Tag ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>key</code></td>
<td>string</td>
<td>Tag key</td>
</tr>
<tr>
<td><code>values</code></td>
<td>array(string)</td>
<td>Array of attribute tags</td>
</tr>
</tbody></table>
<h2 id='delete-tag'>Delete Tag</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/tags/92b7b0dac4 <span class="se">\</span>
  -X DELETE <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>This endpoint deletes an attribute tag with the given ID.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>DELETE /tags/:id</code></p>
<h1 id='communication-settings'>Communication Settings</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>

<p>Sandbox:
<code>
https://api.thanxsandbox.com/communication_settings
</code></p>

<p>This section describes endpoints that enable a third party to fetch and update
a user&#39;s communication settings.</p>
<h2 id='get-communication-settings'>Get Communication Settings</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/communication_settings <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"communication_settings"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weori234098"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"owierywtwt"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"woeruijsfwer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"reward_earned"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"reward_unused"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"reward_progress"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"reward_offer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"feedback_available"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"marketing_general"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns a user&#39;s communication settings. The <code>notification</code> key
reflects a user&#39;s settings for receiving push notifications in their app or
via text if they don&#39;t have an app installed. The <code>email</code> key reflects a user&#39;s
settings for receiving emails.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /communication_settings</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Merchant ID</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>String</td>
<td>The ID of the settings record</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>String</td>
<td>The ID of the merchant</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>String</td>
<td>The ID of the user</td>
</tr>
<tr>
<td><code>reward_earned</code></td>
<td>hash</td>
<td>Settings for when a user earns a loyalty reward</td>
</tr>
<tr>
<td><code>reward_earned.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_earned.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_unused</code></td>
<td>hash</td>
<td>Settings for when a user has an unused reward</td>
</tr>
<tr>
<td><code>reward_unused.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_unused.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_progress</code></td>
<td>hash</td>
<td>Settings for when a user earns loyalty progress</td>
</tr>
<tr>
<td><code>reward_progress.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_progress.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_offer</code></td>
<td>hash</td>
<td>Settings for when a merchant sends an offer</td>
</tr>
<tr>
<td><code>reward_offer.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_offer.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>feedback_available</code></td>
<td>hash</td>
<td>Settings for when a user has the opportunity to leave feedback for a purchase</td>
</tr>
<tr>
<td><code>feedback_available.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>marketing_general</code></td>
<td>hash</td>
<td>Settings for when a merchant sends general marketing</td>
</tr>
<tr>
<td><code>marketing_general.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
</tbody></table>
<h2 id='update-communication-settings'>Update Communication Settings</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/communication_settings/woerihfslkwer <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
  -d <span class="s1">'{
    "communication_settings": {
      "reward_earned": {
        "notification": false,
        "email": false
      },
      "feedback_available": {
        "notification": true
      }
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"settings"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weoruoisdhf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"owierywtwt"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"woerushfwe"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"reward_earned"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"reward_unused"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"reward_progress"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"reward_offer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"feedback_available"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"marketing_general"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint allows the update of a user&#39;s notification / email settings.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /communication_settings/:id</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>String</td>
<td>required</td>
<td>The ID of the settings record</td>
</tr>
<tr>
<td><code>reward_earned</code></td>
<td>hash</td>
<td>optional</td>
<td>Settings for when a user earns a loyalty reward</td>
</tr>
<tr>
<td><code>reward_earned.notification</code></td>
<td>boolean</td>
<td>optional</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_earned.email</code></td>
<td>boolean</td>
<td>optional</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_unused</code></td>
<td>hash</td>
<td>optional</td>
<td>Settings for when a user has an unused reward</td>
</tr>
<tr>
<td><code>reward_unused.notification</code></td>
<td>boolean</td>
<td>optional</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_unused.email</code></td>
<td>boolean</td>
<td>optional</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_progress</code></td>
<td>hash</td>
<td>optional</td>
<td>Settings for when a user earns loyalty progress</td>
</tr>
<tr>
<td><code>reward_progress.notification</code></td>
<td>boolean</td>
<td>optional</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_progress.email</code></td>
<td>boolean</td>
<td>optional</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_offer</code></td>
<td>hash</td>
<td>optional</td>
<td>Settings for when a merchant sends an offer</td>
</tr>
<tr>
<td><code>reward_offer.notification</code></td>
<td>boolean</td>
<td>optional</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_offer.email</code></td>
<td>boolean</td>
<td>optional</td>
<td>email setting</td>
</tr>
<tr>
<td><code>feedback_available</code></td>
<td>hash</td>
<td>optional</td>
<td>Settings for when a user has the opportunity to leave feedback for a purchase</td>
</tr>
<tr>
<td><code>feedback_available.notification</code></td>
<td>boolean</td>
<td>optional</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>marketing_general</code></td>
<td>hash</td>
<td>optional</td>
<td>Settings for when a merchant sends general marketing</td>
</tr>
<tr>
<td><code>marketing_general.email</code></td>
<td>boolean</td>
<td>optional</td>
<td>email setting</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>String</td>
<td>The ID of the settings record</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>String</td>
<td>The ID of the merchant</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>String</td>
<td>The ID of the user</td>
</tr>
<tr>
<td><code>reward_earned</code></td>
<td>hash</td>
<td>Settings for when a user earns a loyalty reward</td>
</tr>
<tr>
<td><code>reward_earned.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_earned.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_unused</code></td>
<td>hash</td>
<td>Settings for when a user has an unused reward</td>
</tr>
<tr>
<td><code>reward_unused.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_unused.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_progress</code></td>
<td>hash</td>
<td>Settings for when a user earns loyalty progress</td>
</tr>
<tr>
<td><code>reward_progress.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_progress.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>reward_offer</code></td>
<td>hash</td>
<td>Settings for when a merchant sends an offer</td>
</tr>
<tr>
<td><code>reward_offer.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>reward_offer.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
<tr>
<td><code>feedback_available</code></td>
<td>hash</td>
<td>Settings for when a user has the opportunity to leave feedback for a purchase</td>
</tr>
<tr>
<td><code>feedback_available.notification</code></td>
<td>boolean</td>
<td>app notification setting</td>
</tr>
<tr>
<td><code>marketing_general</code></td>
<td>hash</td>
<td>Settings for when a merchant sends general marketing</td>
</tr>
<tr>
<td><code>marketing_general.email</code></td>
<td>boolean</td>
<td>email setting</td>
</tr>
</tbody></table>
<h1 id='push-registrations'>Push Registrations</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>

<p>Sandbox:
<code>
https://api.thanxsandbox.com/push_registrations
</code></p>

<p>This section describes endpoints that enable a third party to register a device
for push notifications.</p>
<h2 id='create-push-registration'>Create Push Registration</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/push_registrations <span class="se">\</span>
  -X PUT <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
  -d <span class="s1">'{
    "push_registration": {
      "device_type": "ios",
      "token": "wourdweroi238432423425fsgd"
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 ok)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"push_registration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wourdweroi238432423425fsgd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"device_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint creates or updates a push registration record for a user&#39;s device.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PUT /push_registrations</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>device_type</code></td>
<td>enum</td>
<td>Required</td>
<td>The type of device: (<code>ios</code>, <code>android</code>)</td>
</tr>
<tr>
<td><code>token</code></td>
<td>string</td>
<td>Required</td>
<td>The token returned by the local push notification library</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>device_type</code></td>
<td>enum</td>
<td>The type of device: (<code>ios</code>, <code>android</code>)</td>
</tr>
<tr>
<td><code>token</code></td>
<td>string</td>
<td>The registration token</td>
</tr>
</tbody></table>
<h1 id='loyalty'>Loyalty</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>

<p>Sandbox:
<code>
https://api.thanxsandbox.com/loyalty_statuses
</code></p>

<p>This section describes endpoints that enable a third party to fetch a user&#39;s
progress in the loyalty program.</p>
<h2 id='describe-loyalty-status'>Describe Loyalty Status</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/loyalty_statuses <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"loyalty_statuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wruflst"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weorui"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weoru"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spend"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$10 off"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes the user&#39;s current loyalty statuses.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /loyalty_statuses</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return loyalty status for this merchant</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The ID of the loyalty status record</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>The user ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>The merchant ID</td>
</tr>
<tr>
<td><code>status</code></td>
<td>hash</td>
<td>The user&#39;s loyalty information</td>
</tr>
<tr>
<td><code>status.progress</code></td>
<td>integer</td>
<td>The user&#39;s progress toward their reward, out of 100</td>
</tr>
<tr>
<td><code>status.type</code></td>
<td>enum</td>
<td>Whether the user earns progress via how much they spend or how many times they visit. Returns &#39;spend&#39; or &#39;visit&#39;.</td>
</tr>
<tr>
<td><code>status.threshold</code></td>
<td>integer</td>
<td>How much the user needs to spend or how many visits the user needs to make to earn the reward.</td>
</tr>
<tr>
<td><code>redeem</code></td>
<td>hash</td>
<td>Describes the reward the user would earn</td>
</tr>
<tr>
<td><code>redeem.type</code></td>
<td>enum</td>
<td>How the reward can be redeemed (<code>manual</code>, <code>automatic</code>)</td>
</tr>
<tr>
<td><code>redeem.text</code></td>
<td>string</td>
<td>Description of what the reward is</td>
</tr>
<tr>
<td><code>redeem.venue</code></td>
<td>enum</td>
<td>Where the reward can be used: (<code>instore</code>, <code>online</code>, <code>all</code>)</td>
</tr>
</tbody></table>
<h1 id='tiers'>Tiers</h1>
<blockquote>
<p>API Endpoint
<code>
https://api.thanxsandbox.com/tiers
</code></p>
</blockquote>

<p>This section describes endpoints that enable a third party to fetch the configuration
of a merchant&#39;s tiers.</p>
<h2 id='describe-tiers-configuration'>Describe Tiers Configuration</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/tier_configurations <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"tier_configurations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weoru"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bronze_tier"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wyreo23"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bronze"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"- $10 off purchase of $25+ - complimentary birthday dessert - special event invitations"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#ba7556"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"spend_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"progress_paddle_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/401/two_x/two_x-792ff91da8f50f9b5bfed570cef94295.png?1607038403"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/401/three_x/three_x-792ff91da8f50f9b5bfed570cef94295.png?1607038403"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/401/three_x/three_x-792ff91da8f50f9b5bfed570cef94295.png?1607038403"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"background_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/400/two_x/two_x-463afd8be775b5ac6909bbaabf692353.jpg?1607038403"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/400/three_x/three_x-463afd8be775b5ac6909bbaabf692353.jpg?1607038403"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/400/three_x/three_x-463afd8be775b5ac6909bbaabf692353.jpg?1607038403"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"icon_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/397/two_x/two_x-73db1207a1143a6f68374b119f826aa9.png?1607038181"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/397/three_x/three_x-73db1207a1143a6f68374b119f826aa9.png?1607038181"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/397/three_x/three_x-73db1207a1143a6f68374b119f826aa9.png?1607038181"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"silver_tier"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fh457"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Silver"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Everything in Bronze, plus: - early reservations to community dinners when you reach Silver Tier"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#bdbec0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"spend_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">1500</span><span class="p">,</span><span class="w">
        </span><span class="s2">"progress_paddle_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/403/two_x/two_x-432dd66aa8b2f7aededebc434fa36232.png?1607038424"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/403/three_x/three_x-432dd66aa8b2f7aededebc434fa36232.png?1607038424"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/403/three_x/three_x-432dd66aa8b2f7aededebc434fa36232.png?1607038424"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"background_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/402/two_x/two_x-1fbd60df2de3891d3f41d915bd2afef4.jpg?1607038423"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/402/three_x/three_x-1fbd60df2de3891d3f41d915bd2afef4.jpg?1607038423"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/402/three_x/three_x-1fbd60df2de3891d3f41d915bd2afef4.jpg?1607038423"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"icon_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/398/two_x/two_x-f7a86c1434d71199a717d2b0caa256ac.png?1607038197"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/398/three_x/three_x-f7a86c1434d71199a717d2b0caa256ac.png?1607038197"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/398/three_x/three_x-f7a86c1434d71199a717d2b0caa256ac.png?1607038197"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"gold_tier"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ert235"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Gold"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Everything in Silver, plus: - complimentary seasonal pizza per year when you reach Gold Tier"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#c8b55e"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"spend_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">3000</span><span class="p">,</span><span class="w">
        </span><span class="s2">"progress_paddle_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/405/two_x/two_x-33c3dc14517c5d08b2c0869ef52c652b.png?1607038443"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/405/three_x/three_x-33c3dc14517c5d08b2c0869ef52c652b.png?1607038443"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/405/three_x/three_x-33c3dc14517c5d08b2c0869ef52c652b.png?1607038443"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"background_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/404/two_x/two_x-3fbfb464595f7e136cfccebf36f2b1d8.jpg?1607038443"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/404/three_x/three_x-3fbfb464595f7e136cfccebf36f2b1d8.jpg?1607038443"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/404/three_x/three_x-3fbfb464595f7e136cfccebf36f2b1d8.jpg?1607038443"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"icon_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/399/two_x/two_x-a44437b769db59fb777c922088ec840d.png?1607038208"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/399/three_x/three_x-a44437b769db59fb777c922088ec840d.png?1607038208"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/399/three_x/three_x-a44437b769db59fb777c922088ec840d.png?1607038208"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"progress_bar_image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/423/two_x/two_x-ecbb385cc1850f090c6305fcc427293b.png?1608147464"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/423/three_x/three_x-ecbb385cc1850f090c6305fcc427293b.png?1608147464"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/423/three_x/three_x-ecbb385cc1850f090c6305fcc427293b.png?1608147464"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes tier configurations for the merchants accessible via the
provided credentials. The gold tier may not be present if the merchant opts to have only 2 tiers.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /tier_configurations</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return tier configuration for this merchant</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>The merchant ID</td>
</tr>
<tr>
<td><code>bronze_tier</code></td>
<td>hash</td>
<td>Describes the configuration for the bronze tier</td>
</tr>
<tr>
<td><code>bronze_tier.id</code></td>
<td>string</td>
<td>The identifer of the tier record</td>
</tr>
<tr>
<td><code>bronze_tier.name</code></td>
<td>string</td>
<td>The display name for the tier</td>
</tr>
<tr>
<td><code>bronze_tier.description</code></td>
<td>string</td>
<td>Describes the perks of the tier. Can return markdown.</td>
</tr>
<tr>
<td><code>bronze_tier.color</code></td>
<td>string</td>
<td>The hex color to use for this tier.</td>
</tr>
<tr>
<td><code>bronze_tier.spend_threshold</code></td>
<td>integer</td>
<td>How much the user needs to spend to be part of the tier.</td>
</tr>
<tr>
<td><code>bronze_tier.progress_paddle_image</code></td>
<td>hash</td>
<td>The image configured to render on the progress bar for tiers</td>
</tr>
<tr>
<td><code>bronze_tier.progress_paddle_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>bronze_tier.progress_paddle_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>bronze_tier.progress_paddle_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>bronze_tier.background_image</code></td>
<td>hash</td>
<td>The image configured to render as the background for the tier</td>
</tr>
<tr>
<td><code>bronze_tier.background_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>bronze_tier.background_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>bronze_tier.background_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>bronze_tier.icon_image</code></td>
<td>hash</td>
<td>The image configured to render as the icon for the tier</td>
</tr>
<tr>
<td><code>bronze_tier.icon_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>bronze_tier.icon_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>bronze_tier.icon_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>silver_tier</code></td>
<td>hash</td>
<td>Describes the configuration for the silver tier</td>
</tr>
<tr>
<td><code>silver_tier.id</code></td>
<td>string</td>
<td>The identifer of the tier record</td>
</tr>
<tr>
<td><code>silver_tier.name</code></td>
<td>string</td>
<td>The display name for the tier</td>
</tr>
<tr>
<td><code>silver_tier.description</code></td>
<td>string</td>
<td>Describes the perks of the tier. Can return markdown.</td>
</tr>
<tr>
<td><code>silver_tier.color</code></td>
<td>string</td>
<td>The hex color to use for this tier.</td>
</tr>
<tr>
<td><code>silver_tier.spend_threshold</code></td>
<td>integer</td>
<td>How much the user needs to spend to be part of the tier.</td>
</tr>
<tr>
<td><code>silver_tier.progress_paddle_image</code></td>
<td>hash</td>
<td>The image configured to render on the progress bar for tiers</td>
</tr>
<tr>
<td><code>silver_tier.progress_paddle_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>silver_tier.progress_paddle_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>silver_tier.progress_paddle_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>silver_tier.background_image</code></td>
<td>hash</td>
<td>The image configured to render as the background for the tier</td>
</tr>
<tr>
<td><code>silver_tier.background_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>silver_tier.background_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>silver_tier.background_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>silver_tier.icon_image</code></td>
<td>hash</td>
<td>The image configured to render as the icon for the tier</td>
</tr>
<tr>
<td><code>silver_tier.icon_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>silver_tier.icon_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>silver_tier.icon_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>gold_tier</code></td>
<td>hash</td>
<td>Describes the configuration for the gold tier</td>
</tr>
<tr>
<td><code>gold_tier.id</code></td>
<td>string</td>
<td>The identifer of the tier record</td>
</tr>
<tr>
<td><code>gold_tier.name</code></td>
<td>string</td>
<td>The display name for the tier</td>
</tr>
<tr>
<td><code>gold_tier.description</code></td>
<td>string</td>
<td>Describes the perks of the tier. Can return markdown.</td>
</tr>
<tr>
<td><code>gold_tier.color</code></td>
<td>string</td>
<td>The hex color to use for this tier.</td>
</tr>
<tr>
<td><code>gold_tier.spend_threshold</code></td>
<td>integer</td>
<td>How much the user needs to spend to be part of the tier.</td>
</tr>
<tr>
<td><code>gold_tier.progress_paddle_image</code></td>
<td>hash</td>
<td>The image configured to render on the progress bar for tiers</td>
</tr>
<tr>
<td><code>gold_tier.progress_paddle_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>gold_tier.progress_paddle_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>gold_tier.progress_paddle_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>gold_tier.background_image</code></td>
<td>hash</td>
<td>The image configured to render as the background for the tier</td>
</tr>
<tr>
<td><code>gold_tier.background_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>gold_tier.background_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>gold_tier.background_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>gold_tier.icon_image</code></td>
<td>hash</td>
<td>The image configured to render as the icon for the tier</td>
</tr>
<tr>
<td><code>gold_tier.icon_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>gold_tier.icon_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>gold_tier.icon_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
<tr>
<td><code>progress_bar_image</code></td>
<td>hash</td>
<td>The image configured to render as the progress bar for tiers</td>
</tr>
<tr>
<td><code>progress_bar_image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>progress_bar_image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>progress_bar_image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
</tbody></table>
<h2 id='describe-tier-status'>Describe Tier Status</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/tier_statuses <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"tier_statuses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weourif"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"woeru"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werouwer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bronze"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"action_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spend $100 before the end of the year to earn Silver."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"current_tier_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bronze"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"next_tier_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Silver"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes the user&#39;s current tier statuses.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /tier_statuses</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return tier status for this merchant</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The ID of the tier status record</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>The user ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>The merchant ID</td>
</tr>
<tr>
<td><code>level</code></td>
<td>enum</td>
<td>Current tier state (<code>bronze</code>, <code>silver</code>, <code>gold</code>)</td>
</tr>
<tr>
<td><code>action_text</code></td>
<td>string</td>
<td>Description of what the user needs to do in order to earn the next tier</td>
</tr>
<tr>
<td><code>progress</code></td>
<td>decimal</td>
<td>Amount spent so far</td>
</tr>
<tr>
<td><code>expires_at</code></td>
<td>string</td>
<td>Current tier status expiration in ISO8601-format</td>
</tr>
<tr>
<td><code>current_tier_name</code></td>
<td>string</td>
<td>Name of current tier</td>
</tr>
<tr>
<td><code>next_tier_name</code></td>
<td>string</td>
<td>Name of next tier. This will be blank if the user has <code>gold</code> status</td>
</tr>
</tbody></table>
<h2 id='grant-tier-status'>Grant Tier Status</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/tier_statuses/:id <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
  -d <span class="s1">'{
    "tier_status": {
      "level": "silver"
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"tier_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weourif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"woeru"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werouwer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bronze"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"action_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spend $100 before the end of the year to earn Silver."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"progress"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"current_tier_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bronze"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"next_tier_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Silver"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint allows you to modify a user&#39;s tier status.
<strong>This endpoint is only available in SANDBOX</strong></p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /tier_statuses/:id</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>level</code></td>
<td>enum</td>
<td>Required</td>
<td>The desired tier (<code>bronze</code>, <code>silver</code>, <code>gold</code>)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The ID of the tier status record</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>The user ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>The merchant ID</td>
</tr>
<tr>
<td><code>level</code></td>
<td>enum</td>
<td>Current tier state (<code>bronze</code>, <code>silver</code>, <code>gold</code>)</td>
</tr>
<tr>
<td><code>action_text</code></td>
<td>string</td>
<td>Description of what the user needs to do in order to earn the next tier</td>
</tr>
<tr>
<td><code>progress</code></td>
<td>integer</td>
<td>Progress percent toward the next tier (0-99)</td>
</tr>
<tr>
<td><code>expires_at</code></td>
<td>string</td>
<td>Current tier status expiration in ISO8601-format</td>
</tr>
<tr>
<td><code>current_tier_name</code></td>
<td>string</td>
<td>Name of current tier</td>
</tr>
<tr>
<td><code>next_tier_name</code></td>
<td>string</td>
<td>Name of next tier. This will be blank if the user has <code>gold</code> status</td>
</tr>
</tbody></table>
<h1 id='feedbacks'>Feedbacks</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.thanxsandbox.com/feedbacks
</code></pre>
<p>This section describes endpoints that enable a third party to view and update
a user&#39;s feedback (NPS) records.</p>
<h2 id='describe-feedback'>Describe Feedback</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/feedbacks <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>

<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"feedbacks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"590485d6f0"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fsjlk"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"woeri34"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"location_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-07T20:00:00Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"review"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"purchase"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"916895d48a"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">16.0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aepo3cme2p"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OpenTender"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint describes the user&#39;s current feedback records.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /feedbacks</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Feedback ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>location_id</code></td>
<td>string</td>
<td>Location ID</td>
</tr>
<tr>
<td><code>expires_at</code></td>
<td>string</td>
<td>Time the feedback expires in ISO8601-format</td>
</tr>
<tr>
<td><code>rating</code></td>
<td>integer</td>
<td>NPS score (null or 1-10)</td>
</tr>
<tr>
<td><code>review</code></td>
<td>string</td>
<td>Customer feedback</td>
</tr>
<tr>
<td><code>purchase.id</code></td>
<td>string</td>
<td>Purchase ID</td>
</tr>
<tr>
<td><code>purchase.purchased_at</code></td>
<td>string</td>
<td>Time the purchase was made in ISO8601-format</td>
</tr>
<tr>
<td><code>purchase.amount</code></td>
<td>decimal</td>
<td>Purchase amount</td>
</tr>
<tr>
<td><code>purchase.order</code></td>
<td>hash</td>
<td>Provides information about the associated order, if any</td>
</tr>
<tr>
<td><code>purchase.order.provider</code></td>
<td>enum</td>
<td>The online ordering provider (<code>OLO</code>, <code>Toast</code>, <code>OpenTender</code>, <code>Other</code>)</td>
</tr>
<tr>
<td><code>purchase.order.id</code></td>
<td>string</td>
<td>The ID of the order in the provider&#39;s system</td>
</tr>
</tbody></table>
<h2 id='get-single-feedback'>Get Single Feedback</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/feedbacks/590485d6f0 <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>

<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"feedback"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"590485d6f0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fsjlk"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"woeri34"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"location_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-07T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"rating"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"review"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"purchase"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"916895d48a"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">16.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aepo3cme2p"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OpenTender"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint returns the feedback record corresponding with the ID in the path. If the user
is no longer able to leave feedback for this purchase, a 404 will be returned instead.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /feedbacks/:id</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Feedback ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>location_id</code></td>
<td>string</td>
<td>Location ID</td>
</tr>
<tr>
<td><code>expires_at</code></td>
<td>string</td>
<td>Time the feedback expires in ISO8601-format</td>
</tr>
<tr>
<td><code>rating</code></td>
<td>integer</td>
<td>NPS score (null or 1-10)</td>
</tr>
<tr>
<td><code>review</code></td>
<td>string</td>
<td>Customer feedback</td>
</tr>
<tr>
<td><code>purchase.id</code></td>
<td>string</td>
<td>Purchase ID</td>
</tr>
<tr>
<td><code>purchase.purchased_at</code></td>
<td>string</td>
<td>Time the purchase was made in ISO8601-format</td>
</tr>
<tr>
<td><code>purchase.amount</code></td>
<td>decimal</td>
<td>Purchase amount</td>
</tr>
<tr>
<td><code>purchase.order</code></td>
<td>hash</td>
<td>Provides information about the associated order, if any</td>
</tr>
<tr>
<td><code>purchase.order.provider</code></td>
<td>enum</td>
<td>The online ordering provider (<code>OLO</code>, <code>Toast</code>, <code>OpenTender</code>, <code>Other</code>)</td>
</tr>
<tr>
<td><code>purchase.order.id</code></td>
<td>string</td>
<td>The ID of the order in the provider&#39;s system</td>
</tr>
</tbody></table>
<h2 id='update-feedback'>Update Feedback</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/feedbacks/590485d6f0 <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
  -d <span class="s1">'{
    "feedback": {
      "rating": 10,
      "review": "Lorem ipsum dolor sit amet"
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>

<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"feedback"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"590485d6f0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weorifsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1f0772c"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"location_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-07T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"rating"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="s2">"review"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lorem ipsum dolor sit amet"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"purchase"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wourhfiwer"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">9.99</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aepo3cme2p"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OpenTender"</span><span class="w">
      </span><span class="p">},</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint will update a user&#39;s feedback record. If your API permissions allow it (this is rare),
you may use the STANDARD_HEADERS rather than the AUTH_HEADERS.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /feedbacks/:id</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>rating</code></td>
<td>integer</td>
<td>Required</td>
<td>NPS Score, 1-10</td>
</tr>
<tr>
<td><code>review</code></td>
<td>string</td>
<td>Optional</td>
<td>Customer feedback</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Feedback ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>location_id</code></td>
<td>string</td>
<td>Location ID</td>
</tr>
<tr>
<td><code>expires_at</code></td>
<td>string</td>
<td>Time the feedback expires in ISO8601-format</td>
</tr>
<tr>
<td><code>rating</code></td>
<td>integer</td>
<td>NPS score (null or 1-10)</td>
</tr>
<tr>
<td><code>review</code></td>
<td>string</td>
<td>Customer feedback</td>
</tr>
<tr>
<td><code>purchase.id</code></td>
<td>string</td>
<td>Purchase ID</td>
</tr>
<tr>
<td><code>purchase.purchased_at</code></td>
<td>string</td>
<td>Time the purchase was made in ISO8601-format</td>
</tr>
<tr>
<td><code>purchase.amount</code></td>
<td>decimal</td>
<td>Purchase amount</td>
</tr>
<tr>
<td><code>purchase.order</code></td>
<td>hash</td>
<td>Provides information about the associated order, if any</td>
</tr>
<tr>
<td><code>purchase.order.provider</code></td>
<td>enum</td>
<td>The online ordering provider (<code>OLO</code>, <code>Toast</code>, <code>OpenTender</code>, <code>Other</code>)</td>
</tr>
<tr>
<td><code>purchase.order.id</code></td>
<td>string</td>
<td>The ID of the order in the provider&#39;s system</td>
</tr>
</tbody></table>
<h1 id='purchases'>Purchases</h1>
<blockquote>
<p>API Endpoint
Sandbox:
<code>
https://api.thanxsandbox.com/purchases
</code></p>
</blockquote>

<p>This section describes endpoints that enable a third party to fetch a user&#39;s purchases.</p>
<h2 id='describe-purchases'>Describe Purchases</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/purchases <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"purchases"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weori235"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1f0772c9ac"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"location_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e7183da044"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">9.99</span><span class="p">,</span><span class="w">
      </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OLO"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YWEI2342F"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes all available purchases.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /purchases</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return purchases for this merchant</td>
</tr>
<tr>
<td><code>location_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return purchases for this location</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return purchases for this user. Note: the bearer token will be used to determine which user&#39;s purchases are being requested when the request is made by a logged in user.</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Reward ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>location_id</code></td>
<td>string</td>
<td>Location ID</td>
</tr>
<tr>
<td><code>purchased_at</code></td>
<td>string</td>
<td>Time the purchase was made in ISO8601-format</td>
</tr>
<tr>
<td><code>amount</code></td>
<td>decimal</td>
<td>The purchase amount</td>
</tr>
<tr>
<td><code>order</code></td>
<td>hash</td>
<td>Provides information about the associated order, if any</td>
</tr>
<tr>
<td><code>order.provider</code></td>
<td>enum</td>
<td>The online ordering provider (<code>OLO</code>, <code>Toast</code>, <code>OpenTender</code>, <code>Other</code>)</td>
</tr>
<tr>
<td><code>order.id</code></td>
<td>string</td>
<td>The ID of the order in the provider&#39;s system</td>
</tr>
</tbody></table>
<h2 id='get-single-purchase'>Get Single Purchase</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/purchases/92b7b0dac4 <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"purchase"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weori235"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1f0772c9ac"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"location_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e7183da044"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">9.99</span><span class="p">,</span><span class="w">
    </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OLO"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"YWEI2342F"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns the purchase associated with the id in the path.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /purchases/:purchase_id</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Reward ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>location_id</code></td>
<td>string</td>
<td>Location ID</td>
</tr>
<tr>
<td><code>purchased_at</code></td>
<td>string</td>
<td>Time the purchase was made in ISO8601-format</td>
</tr>
<tr>
<td><code>amount</code></td>
<td>decimal</td>
<td>The purchase amount</td>
</tr>
<tr>
<td><code>order</code></td>
<td>hash</td>
<td>Provides information about the associated order, if any</td>
</tr>
<tr>
<td><code>order.provider</code></td>
<td>enum</td>
<td>The online ordering provider (<code>OLO</code>, <code>Toast</code>, <code>OpenTender</code>, <code>Other</code>)</td>
</tr>
<tr>
<td><code>order.id</code></td>
<td>string</td>
<td>The ID of the order in the provider&#39;s system</td>
</tr>
</tbody></table>
<h2 id='create-purchase'>Create Purchase</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/purchases <span class="se">\</span>
  -X POST <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
  -d <span class="s1">'{
    "purchase": {
      "merchant_id":  "weoru",
      "location_id":  "hljkfd2345",
      "user_id":      "wgljsdwer23",
      "amount":       13.45,
      "purchased_at": "2020-09-15T00:52:10.655+00:00",
      "card_id":      null
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (201 CREATED)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>This endpoint submits a purchase to our system for processing. Because this
purchase is processed asynchronously, there is no response JSON. Please allow up
to a couple minutes to receive this purchase back from the GET /purchases endpoint.
<strong>This endpoint is only available in SANDBOX</strong></p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /purchases</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Required</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>location_id</code></td>
<td>string</td>
<td>Required</td>
<td>Location ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>Required</td>
<td>User ID</td>
</tr>
<tr>
<td><code>amount</code></td>
<td>decimal</td>
<td>Required</td>
<td>The amount of the receipt</td>
</tr>
<tr>
<td><code>purchased_at</code></td>
<td>string</td>
<td>Required</td>
<td>The timestamp of the purchase, in ISO8601</td>
</tr>
<tr>
<td><code>card_id</code></td>
<td>string</td>
<td>Optional</td>
<td>The card the user used, if it is registered in Thanx</td>
</tr>
</tbody></table>
<h2 id='update-purchase-tags'>Update Purchase Tags</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/purchases/wourhfiwer/tags <span class="se">\</span>
  -X PUT <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
  -d <span class="s1">'{
    "tag": {
      "key": "server_satisfaction",
      "values": [
        "10"
      ]
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"tag"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werwerr"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"purchase_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wourhfiwer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"server_satisfaction"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"10"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint updates an attribute tag for the given purchase. The tag associated with
the key in the request will be created or updated with the values passed in.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PUT /purchases/:purchase_id/tags</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>key</code></td>
<td>string</td>
<td>Required</td>
<td>Tag key</td>
</tr>
<tr>
<td><code>values</code></td>
<td>array(string)</td>
<td>Required</td>
<td>Array of attributes tags</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Tag ID</td>
</tr>
<tr>
<td><code>purchase_id</code></td>
<td>string</td>
<td>Purchase ID</td>
</tr>
<tr>
<td><code>key</code></td>
<td>string</td>
<td>Tag key</td>
</tr>
<tr>
<td><code>values</code></td>
<td>array(string)</td>
<td>Array of attribute tags</td>
</tr>
</tbody></table>
<h1 id='receipts'>Receipts</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>

<p>Sandbox:
<code>
https://api.thanxsandbox.com/receipts
</code></p>

<p>This section describes endpoints that enable a third party to submit and view
receipts for a user. In order to submit a receipt to Thanx, you must first make a request
to the API to get a presigned upload URL. Once you have uploaded the image to this URL,
make a <code>POST /receipts</code> request to create the receipt in Thanx.</p>
<h2 id='describe-presigned-url'>Describe Presigned URL</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/upload_url?upload_type<span class="o">=</span>receipt <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"upload_url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://thanx.s3.amazonaws.com/uploads/receipts/image_5051555_1534872299.jpeg?AWS-PARAMS"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"file_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uploads/receipts/image_5051555_1534872299.jpeg"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint provides a presigned url where an image or file can be uploaded.
The <code>file_path</code> can be used as the input to the <code>POST /receipts</code> endpoint.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /upload_url</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>upload_type</td>
<td>enum</td>
<td>Required</td>
<td>The type of upload; currently only option is (<code>receipt</code>)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>url</code></td>
<td>string</td>
<td>Url to upload the image to</td>
</tr>
<tr>
<td><code>file_path</code></td>
<td>string</td>
<td>Path where the image will be saved</td>
</tr>
</tbody></table>
<h2 id='describe-receipts'>Describe Receipts</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/receipts <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"receipts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weorufsdf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werouf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"rejection_text"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">13.45</span><span class="p">,</span><span class="w">
      </span><span class="s2">"payment_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cash"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T00:52:10.655+00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"submitted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T00:55:11.876+00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_comments"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit card reader was not working"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"card_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/363/thumbnail/thumbnail-612c5e1821440637c0137be46d141e07.jpg?1604507010"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/363/medium/medium-612c5e1821440637c0137be46d141e07.jpg?1604507010"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/363/mobile/mobile-612c5e1821440637c0137be46d141e07.jpg?1604507010"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes the receipts in Thanx.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /receipts</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>Optional</td>
<td>User ID. Note: the bearer token will be used to determine which user&#39;s receipts are being requested when the request is made by a logged in user.</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Merchant ID</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The receipt ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>The processing state of the receipt (<code>pending</code>, <code>processing</code>, <code>applied</code>, <code>denied</code>)</td>
</tr>
<tr>
<td><code>rejection_text</code></td>
<td>string</td>
<td>If the receipt is denied, the reason provided</td>
</tr>
<tr>
<td><code>amount</code></td>
<td>decimal</td>
<td>The amount of the receipt</td>
</tr>
<tr>
<td><code>payment_type</code></td>
<td>enum</td>
<td>(<code>card</code>, <code>cash</code>, <code>other</code>)</td>
</tr>
<tr>
<td><code>purchased_at</code></td>
<td>string</td>
<td>The timestamp of the purchase, in ISO8601</td>
</tr>
<tr>
<td><code>submitted_at</code></td>
<td>string</td>
<td>When the user submitted the receipt, in ISO8601</td>
</tr>
<tr>
<td><code>user_comments</code></td>
<td>string</td>
<td>Any user-entered notes</td>
</tr>
<tr>
<td><code>card_id</code></td>
<td>string</td>
<td>The card the user used, if it is registered in Thanx</td>
</tr>
<tr>
<td><code>image</code></td>
<td>hash</td>
<td>The uploaded receipt image information</td>
</tr>
<tr>
<td><code>image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
</tbody></table>
<h2 id='create-receipt'>Create Receipt</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/receipts <span class="se">\</span>
  -X POST <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
  -d <span class="s1">'{
    "receipt": {
      "merchant_id": "weoru",
      "amount": 13.45,
      "payment_type": "cash",
      "purchased_at": "2020-09-15T00:52:10.655+00:00",
      "image_path": "uploads/receipts/image_5051555_1534872299.jpeg",
      "user_comments": "credit card reader was not working",
      "card_id": null
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (201 CREATED)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"receipt"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weorufsdf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"werouf"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"rejection_text"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">13.45</span><span class="p">,</span><span class="w">
    </span><span class="s2">"payment_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cash"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T00:52:10.655+00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"submitted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T00:55:11.876+00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_comments"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit card reader was not working"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"card_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"small"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/363/thumbnail/thumbnail-612c5e1821440637c0137be46d141e07.jpg?1604507010"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"large"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/363/medium/medium-612c5e1821440637c0137be46d141e07.jpg?1604507010"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d1uv7brpxddy46.cloudfront.net/images/363/mobile/mobile-612c5e1821440637c0137be46d141e07.jpg?1604507010"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint submits a receipt for processing.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /receipts</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Required</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>amount</code></td>
<td>decimal</td>
<td>Required</td>
<td>The amount of the receipt</td>
</tr>
<tr>
<td><code>payment_type</code></td>
<td>enum</td>
<td>Required</td>
<td>(<code>card</code>, <code>cash</code>, <code>other</code>)</td>
</tr>
<tr>
<td><code>purchased_at</code></td>
<td>string</td>
<td>Required</td>
<td>The timestamp of the purchase, in ISO8601</td>
</tr>
<tr>
<td><code>image_path</code></td>
<td>string</td>
<td>Required</td>
<td>The path of the uploaded image</td>
</tr>
<tr>
<td><code>user_comments</code></td>
<td>string</td>
<td>Optional</td>
<td>Any user-entered notes</td>
</tr>
<tr>
<td><code>card_id</code></td>
<td>string</td>
<td>Optional</td>
<td>The card the user used, if it is registered in Thanx</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The receipt ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>user_id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>The processing state of the receipt (<code>pending</code>, <code>processing</code>, <code>applied</code>, <code>denied</code>)</td>
</tr>
<tr>
<td><code>rejection_text</code></td>
<td>string</td>
<td>If the receipt is denied, the reason provided</td>
</tr>
<tr>
<td><code>amount</code></td>
<td>decimal</td>
<td>The amount of the receipt</td>
</tr>
<tr>
<td><code>payment_type</code></td>
<td>enum</td>
<td>(<code>card</code>, <code>cash</code>, <code>other</code>)</td>
</tr>
<tr>
<td><code>purchased_at</code></td>
<td>string</td>
<td>The timestamp of the purchase, in ISO8601</td>
</tr>
<tr>
<td><code>submitted_at</code></td>
<td>string</td>
<td>When the user submitted the receipt, in ISO8601</td>
</tr>
<tr>
<td><code>user_comments</code></td>
<td>string</td>
<td>Any user-entered notes</td>
</tr>
<tr>
<td><code>card_id</code></td>
<td>string</td>
<td>The card the user used, if it is registered in Thanx</td>
</tr>
<tr>
<td><code>image</code></td>
<td>hash</td>
<td>The uploaded receipt image information</td>
</tr>
<tr>
<td><code>image.small</code></td>
<td>string</td>
<td>The url for the small version of this image</td>
</tr>
<tr>
<td><code>image.large</code></td>
<td>string</td>
<td>The url for the large version of this image</td>
</tr>
<tr>
<td><code>image.default</code></td>
<td>string</td>
<td>The url for the version of the image usually used by Thanx</td>
</tr>
</tbody></table>
<h1 id='referrals'>Referrals</h1>
<blockquote>
<p>API Endpoint
Sandbox:
<code>
https://api.thanxsandbox.com/referrals
https://api.thanxsandbox.com/referral_links
</code></p>
</blockquote>

<p>This section describes endpoints that enable a third party to fetch a user&#39;s referrals
and referral links.</p>
<h2 id='describe-referral-links'>Describe Referral Links</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/referral_links <span class="se">\</span>
  <span class="nv">$AUTH_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"referral_links"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1f0772c9ac"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://signup.thanx.com/pizza_bob/Jane-23uow234243"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint returns a user&#39;s referral links, one for each merchant the credentials have access to.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /referral_links</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return referral links for this merchant</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>link</code></td>
<td>string</td>
<td>The URL a user can share with others</td>
</tr>
</tbody></table>
<h1 id='locations'>Locations</h1>
<blockquote>
<p>API Endpoint
Sandbox:
<code>
https://api.thanxsandbox.com/locations
</code></p>
</blockquote>

<p>This section describes endpoints that enable a third party to fetch a merchant&#39;s locations.</p>
<h2 id='describe-locations'>Describe Locations</h2><pre class="highlight shell"><code>curl https://api.thanxsandbox.com/locations <span class="se">\</span>
  <span class="nv">$STANDARD_HEADERS</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"locations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"merchant_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1f0772c9ac"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123 Pizza Lane"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smalltown"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pizza Town Co"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(415) 555-3728"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint describes locations accessible for the provided client ID. If a merchant_id
is provided the locations will be further filtered.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /locations</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Optional</td>
<td>Only return locations for this merchant</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Location ID</td>
</tr>
<tr>
<td><code>merchant_id</code></td>
<td>string</td>
<td>Merchant ID</td>
</tr>
<tr>
<td><code>street</code></td>
<td>string</td>
<td>Location&#39;s street address</td>
</tr>
<tr>
<td><code>city</code></td>
<td>string</td>
<td>Location&#39;s city</td>
</tr>
<tr>
<td><code>state</code></td>
<td>string</td>
<td>Location&#39;s state</td>
</tr>
<tr>
<td><code>zip</code></td>
<td>string</td>
<td>Location&#39;s zip code</td>
</tr>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>The name of the location if it has one</td>
</tr>
<tr>
<td><code>phone</code></td>
<td>string</td>
<td>The phone number of the location</td>
</tr>
</tbody></table>
<h1 id='sdk-ios'>SDK iOS</h1>
<p>This section describes the installation and usage of the Thanx iOS SDK. For more details including class and properties documentation, please visit <a href="https://thanx.github.io/thanx-sdk-ios-distribution/">https://thanx.github.io/thanx-sdk-ios-distribution/</a></p>
<h1 id='sdk-android'>SDK Android</h1>
<p>This section describes the installation and usage of the Thanx Android SDK. For more details including class and properties documentation, please visit <a href="https://thanx.github.io/thanx-sdk-android-distribution/">https://thanx.github.io/thanx-sdk-android-distribution/</a></p>
<h1 id='webhooks'>Webhooks</h1>
<p>This section describes webhooks that are available. To request access to our webhook
functionality, please contact your CSM.</p>

<p>In order for Thanx to send webhooks to you, we require an endpoint where you want to receive your payloads.
The payloads are in JSON format and use the same record identifiers as our API endpoints.</p>
<h2 id='purchase-data'>Purchase Data</h2>
<p>A generic purchase webhook payload looks like the first payload listed to the right.</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"purchase"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weori235"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob@bob.com"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1f0772c9ac"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pizza Shack"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e7183da044"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pizza Shack 12"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123 Pizza Lane"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smalltown"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"time_zone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"America/New_York"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"37.76271750294678"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-122.42438230349147"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">9.99</span><span class="p">,</span><span class="w">
    </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"provider"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OLO"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RTF234S"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Snickers"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Twix"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>If you&#39;re a mall and the location hasn&#39;t opted in to data sharing, it will look more
like the second payload listed to the right.</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"purchase"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92b7b0dac4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weori235"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob@bob.com"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a1f0772c9ac"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The Best Mall Ever"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Food"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"purchased_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T20:00:00Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">9.99</span><span class="p">,</span><span class="w">
    </span><span class="s2">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="s2">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='payload-description'>Payload description:</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The ID of the purchase record in Thanx</td>
</tr>
<tr>
<td><code>user</code></td>
<td>hash</td>
<td>User information</td>
</tr>
<tr>
<td><code>user.id</code></td>
<td>string</td>
<td>The ID of the user record in Thanx</td>
</tr>
<tr>
<td><code>user.email</code></td>
<td>string</td>
<td>The user&#39;s email. This value may not be present.</td>
</tr>
<tr>
<td><code>merchant</code></td>
<td>hash</td>
<td>Merchant information</td>
</tr>
<tr>
<td><code>merchant.id</code></td>
<td>string</td>
<td>The ID of the merchant record in Thanx</td>
</tr>
<tr>
<td><code>merchant.name</code></td>
<td>string</td>
<td>The name of the merchant</td>
</tr>
<tr>
<td><code>location</code></td>
<td>hash</td>
<td>Location information</td>
</tr>
<tr>
<td><code>location.name</code></td>
<td>string</td>
<td>The location name or category</td>
</tr>
<tr>
<td><code>location.id</code></td>
<td>string</td>
<td>The ID of the location record in Thanx, if permitted</td>
</tr>
<tr>
<td><code>location.street</code></td>
<td>string</td>
<td>The street address of the location, if permitted</td>
</tr>
<tr>
<td><code>location.city</code></td>
<td>string</td>
<td>The location&#39;s city, if permitted</td>
</tr>
<tr>
<td><code>location.state</code></td>
<td>string</td>
<td>The location&#39;s state, if permitted</td>
</tr>
<tr>
<td><code>location.zip</code></td>
<td>string</td>
<td>The location&#39;s zip code, if permitted</td>
</tr>
<tr>
<td><code>location.time_zone</code></td>
<td>string</td>
<td>The location&#39;s time zone, if permitted</td>
</tr>
<tr>
<td><code>location.latitude</code></td>
<td>string</td>
<td>The location&#39;s latitude, if permitted</td>
</tr>
<tr>
<td><code>location.longitude</code></td>
<td>string</td>
<td>The location&#39;s longitude, if permitted</td>
</tr>
<tr>
<td><code>purchased_at</code></td>
<td>string</td>
<td>Time the purchase was made in ISO8601-format</td>
</tr>
<tr>
<td><code>amount</code></td>
<td>decimal</td>
<td>The purchase amount</td>
</tr>
<tr>
<td><code>order</code></td>
<td>hash</td>
<td>The order information, if this purchase reflects an online order</td>
</tr>
<tr>
<td><code>order.provider</code></td>
<td>enum</td>
<td>(<code>OLO</code>, <code>Toast</code>, <code>OpenTender</code>, <code>Other</code>)</td>
</tr>
<tr>
<td><code>order.id</code></td>
<td>string</td>
<td>The order ID in the provider&#39;s system</td>
</tr>
<tr>
<td><code>products</code></td>
<td>array</td>
<td>The list of products the user bought</td>
</tr>
</tbody></table>
<h1 id='legacy-sso'>[LEGACY] SSO</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>
<pre class="highlight plaintext"><code>https://auth.thanxsandbox.com
</code></pre>
<p>This section describes the process of authenticating with Thanx via Thanx
SSO. Thanx SSO authenticates the user via a password-less flow using email
authentication, rather than a password. This reduces the friction of a user
having to manage yet another password as well as reduces the friction of
transitioning an existing user-base to Thanx.</p>

<p>Thanx follows the standard OAuth 2.0 spec, using the Authorization Code grant
type. Refer to the
<a href="https://tools.ietf.org/html/rfc6749#section-4.1">OAuth 2.0 Authorization Framework RFC: Section 4.1</a>
for additional details.</p>

<p>There are two primary options for implementing SSO with Thanx:</p>

<ul>
<li>Thanx-hosted SSO Form</li>
<li>Self-hosted SSO Form</li>
</ul>
<h2 id='thanx-hosted-sso-form'>Thanx-hosted SSO Form</h2>
<p><img src="images/sso/thanx-hosted-form-1b5e7315.png" alt="SSO with Thanx-hosted Form" /></p>

<ol>
<li>User navigates to the merchant website and clicks an authentication button.</li>
<li>The merchant website redirects to Thanx Auth, as described in the
<code>GET /oauth/authorize</code> endpoint described below.</li>
<li>User enters their email address in the Thanx-hosted form.</li>
<li>If the email address is new to Thanx, the user is prompted to input their
first and last name to create an account, after which an authorization code is
returned to the <code>redirect_uri</code> (skip to step 6). If the email address already
exists in Thanx, Thanx Auth sends an auth email to the specified email.</li>
<li>The user clicks the auth email link which redirects to the merchant website
at the specified <code>redirect_uri</code> with an authorization code in the params.</li>
<li>Merchant website exchanges the authorization code for an access token via
the POST /oauth/token endpoint described below. User is now authenticated with
the Thanx system through the returned access token.</li>
</ol>
<h2 id='self-hosted-sso-form'>Self-hosted SSO Form</h2>
<p><img src="images/sso/self-hosted-form-new-65c29852.png" alt="SSO with Self-hosted Form - New User" />
<img src="images/sso/self-hosted-form-existing-bd5a2fe5.png" alt="SSO with Self-hosted Form - Existing User" /></p>

<ol>
<li>User navigates to the merchant website and clicks an authentication button.</li>
<li>The merchant website prompts the user to input an email address</li>
<li>The merchant website makes a request to the <code>POST /oauth/authorize</code> endpoint
described below. <em>(Continue to #4 or #5)</em></li>
<li>If no account exists for the specified email address, a 401 error is thrown.
The merchant website should then reprompt the user to input a first and last
name and resend the request to <code>POST /oauth/authorize</code> with the <code>first_name</code>
and <code>last_name</code> parameters. Upon successful creation of the user, a 201 HTTP
response is returned with an authorization code in the response body.
<em>(Continue to #6)</em></li>
<li>If an account exists for the specified email address, an auth email is sent
to specified email. The user clicks the auth email link which redirects to the
merchant website at the specified <code>redirect_uri</code> with an authorization code in
the params.</li>
<li>Merchant website exchanges the authorization code for an access token via
the <code>POST /oauth/token</code> endpoint described below. User is now authenticated
with the Thanx system through the returned access token.</li>
</ol>

<p>Note that the following notice with links to the Thanx Privacy Policy and Terms
of Service must be displayed in the user experience where a user signs up.</p>

<p><strong>By signing up you agree to our
<a href="https://app.thanx.com/privacy">privacy policy</a>
and our <a href="https://app.thanx.com/terms">terms of service</a></strong></p>
<h2 id='send-user-to-authentication-flow'>Send user to authentication flow</h2>
<blockquote>
<p>Example Entrypoint</p>
</blockquote>
<pre class="highlight shell"><code>https://auth.thanxsandbox.com/oauth/authorize?<span class="se">\</span>
  <span class="nv">response_type</span><span class="o">=</span>code&amp;<span class="se">\</span>
  <span class="nv">client_id</span><span class="o">=</span>abcdefghijklmnop0123456789&amp;<span class="se">\</span>
  <span class="nv">redirect_uri</span><span class="o">=</span>https%3A%2F%2Fwww.yourdomain.com%2Foauth%2Fcallback
</code></pre>
<p>This is the initial entrance into the authentication flow, rather than an API
endpoint. This is where your &#39;Login with Thanx&#39; button should link to. Be sure
to escape your redirect uri! You will receive a callback at the redirect_url
specified with the session code in the parameters after authentication is
completed.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /oauth/authorize</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>response_type</code></td>
<td>string</td>
<td>Required</td>
<td>This should be <code>code</code></td>
</tr>
<tr>
<td><code>client_id</code></td>
<td>string</td>
<td>Required</td>
<td>This is your client ID</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>string</td>
<td>Required</td>
<td>A redirect_uri (escaped!) where Thanx will redirect to once the user has authenticated. This must be part of a whitelist in Thanx.</td>
</tr>
</tbody></table>
<h2 id='acquire-authorization-code'>Acquire authorization code</h2><pre class="highlight shell"><code>curl https://auth.thanxsandbox.com/oauth/authorize <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "client_id": "f4bf04a6fc27b5fa926a7318933b76440642c25cde037d8e867b3d18d771ad86",
    "redirect_uri": "https://www.example.com/oauth/callback",
    "response_type": "code",
    "scope": "passwordless",
    "username": "john.smith@example.com",
    "first_name": "John",
    "last_name": "Smith",
    "birth_date": "1980-12-15"
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight plaintext"><code>""
</code></pre>
<blockquote>
<p>Response (201 Created)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c13a4ba07f27cfc69a03a5c9cda630205e5f2833331fb761d38eef10c091f371"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (401 Unauthorized)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"access_denied"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"error_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The resource owner or authorization server denied the request."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This flow is to support passwordless login.</p>

<p>If an account exists, an authentication email will be sent including a link that will eventually redirect to the redirect_uri with an authorization code.</p>

<p>If an account does not exist for the specified email, a 401 error will be returned.</p>

<p>If the optionally specified first_name and last_name parameters are included, an attempt to create an account will be made if the email does not already have an associated account. Upon success, a 201 success and an authorization code will be returned.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /oauth/authorize</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>client_id</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client ID</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>string</td>
<td>Required</td>
<td>Where you want the user to be redirected</td>
</tr>
<tr>
<td><code>response_type</code></td>
<td>string</td>
<td>Required</td>
<td><code>code</code> is the required value</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>string</td>
<td>Required</td>
<td><code>passwordless</code> is the required value</td>
</tr>
<tr>
<td><code>username</code></td>
<td>string</td>
<td>Required</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s first name. Must be specified to trigger user creation</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s last name. Must be specified to trigger user creation</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>string</td>
<td>Optional</td>
<td>The user&#39;s birth date. Should be in the format YYYY-MM-DD. Optionally specified during user creation</td>
</tr>
</tbody></table>
<h2 id='acquire-access-token'>Acquire access token</h2><pre class="highlight shell"><code>curl https://auth.thanxsandbox.com/oauth/token <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
  {
    "grant_type": "authorization_code",
    "client_id": "f4bf04a6fc27b5fa926a7318933b76440642c25cde037d8e867b3d18d771ad86",
    "client_secret": "83c08861ce6302e0e73d28cea30aa3f8f3ea98446e133fde60a86231f50f5c82",
    "code": "c13a4ba07f27cfc69a03a5c9cda630205e5f2833331fb761d38eef10c091f371",
    "redirect_uri": "https://www.example.com/oauth/callback"
  }
</span></code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passwordless"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1577836800</span><span class="p">,</span><span class="w">
    </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c74334301a7c74d21b714c905fd3047177dab56de6a86899e6f6b7f71bab7d55"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Use this endpoint to acquire a user&#39;s access token. This same endpoint supports refreshing an access token using the client_id, client_secret, and refresh_token, with grant_type set to <code>refresh_token</code>.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /oauth/token</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>grant_type</code></td>
<td>string</td>
<td>Required</td>
<td><code>authorization_code</code> is the required value</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client Secret</td>
</tr>
<tr>
<td><code>code</code></td>
<td>string</td>
<td>Required</td>
<td>The authorization code received from Thanx via redirect or API</td>
</tr>
<tr>
<td><code>redirect_uri</code></td>
<td>string</td>
<td>Required</td>
<td>The same redirect_uri should be used as in the request for the authorization code</td>
</tr>
</tbody></table>
<h2 id='revoke-access-token'>Revoke Access Token</h2><pre class="highlight shell"><code>curl https://auth.thanxsandbox.com/oauth/revoke <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "client_id": "f4bf04a6fc27b5fa926a7318933b76440642c25cde037d8e867b3d18d771ad86",
    "client_secret": "83c08861ce6302e0e73d28cea30aa3f8f3ea98446e133fde60a86231f50f5c82",
    "token": "945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p>Use this endpoint to revoke a user&#39;s access token.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /oauth/revoke</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>client_id</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Client Secret</td>
</tr>
<tr>
<td><code>token</code></td>
<td>string</td>
<td>Required</td>
<td>OAuth Access Token</td>
</tr>
</tbody></table>
<h2 id='describe-user'>Describe User</h2><pre class="highlight shell"><code>curl https://auth.thanxsandbox.com/users/me <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11650a5cad69"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"birth_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1980-12-15"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (401 Unauthorized)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="s2">""</span><span class="w">
</span></code></pre>
<p>This endpoint will return info for the authorized user</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /users/me</code></p>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Thanx User UID</td>
</tr>
<tr>
<td><code>identifier</code></td>
<td>string</td>
<td>Thanx User Identifier</td>
</tr>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>The user&#39;s first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>The user&#39;s last name</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>string</td>
<td>Optional</td>
</tr>
</tbody></table>
<h1 id='legacy-identity'>[LEGACY] Identity</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>
<pre class="highlight plaintext"><code>https://merchant.thanxsandbox.io
</code></pre>
<p>These APIs enable merchants to fully own their users by providing the ability to create user records on the Thanx platform and transparently authenticate them. This enables merchants to embed the Thanx consumer experience into merchant-owned mobile or web experiences without requiring end-users to re-authenticate with Thanx.</p>
<h2 id='create-user'>Create user</h2><pre class="highlight shell"><code>curl https://merchant.thanxsandbox.io/merchants/1/users <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Accept: application/vnd.thanx-v1+json"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span>
  -d <span class="s1">'{
    "user": {
      "email": "john.smith@example.com",
      "first_name": "John",
      "last_name": "Smith",
      "birth_date": "1980-12-15"
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (201 Created)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (400 Bad Request)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid user birthday"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (409 Conflict)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A user with that email already exists"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint allow creation of users. Users that are created by this mechanism
are automatically associated with the specified merchant. If this specified
merchant attempts to create a user with an email that is already in the Thanx
system but not yet associated with the merchant, the request will succeed and
return a user identifier that is consistent across merchants.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /merchants/:merchant_id/users</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>Required</td>
<td>User&#39;s email address</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>Required</td>
<td>User&#39;s first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>Required</td>
<td>User&#39;s last name</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>string</td>
<td>Optional</td>
<td>User&#39;s birth date in the format YYYY-MM-DD</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>user</code></td>
<td>hash</td>
<td>User info</td>
</tr>
<tr>
<td><code>user.id</code></td>
<td>string</td>
<td>User ID</td>
</tr>
<tr>
<td><code>user.email</code></td>
<td>string</td>
<td>User email address</td>
</tr>
<tr>
<td><code>user.first_name</code></td>
<td>string</td>
<td>User first name</td>
</tr>
<tr>
<td><code>user.last_name</code></td>
<td>string</td>
<td>User last name</td>
</tr>
</tbody></table>
<h2 id='describe-user'>Describe user</h2><pre class="highlight shell"><code>curl https://merchant.thanxsandbox.io/merchants/1/users/2 <span class="se">\</span>
  -H <span class="s2">"Accept: application/vnd.thanx-v1+json"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (404 Not Found)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="s2">""</span><span class="w">
</span></code></pre>
<p>This endpoint will return the specified user</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /merchants/:merchant_id/users/:user_id</code></p>
<h2 id='describe-users'>Describe users</h2><pre class="highlight shell"><code>curl https://merchant.thanxsandbox.io/merchants/1/users <span class="se">\</span>
  -H <span class="s2">"Accept: application/vnd.thanx-v1+json"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint will return a paginated list of users associated with the merchant</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /merchants/:merchant_id/users</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>Optional</td>
<td>Scope list of users by email</td>
</tr>
<tr>
<td><code>page</code></td>
<td>integer</td>
<td>Optional</td>
<td>Page of results to return</td>
</tr>
<tr>
<td><code>per_page</code></td>
<td>integer</td>
<td>Optional</td>
<td>Number of results to return per page (1 to 100)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>Optional</td>
<td>Scope list of users by email</td>
</tr>
<tr>
<td><code>page</code></td>
<td>integer</td>
<td>Optional</td>
<td>Page of results to return</td>
</tr>
<tr>
<td><code>per_page</code></td>
<td>integer</td>
<td>Optional</td>
<td>Number of results to return per page (1 to 100)</td>
</tr>
</tbody></table>
<h2 id='update-user'>Update user</h2><pre class="highlight shell"><code>curl https://merchant.thanxsandbox.io/merchants/1/users <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -H <span class="s2">"Accept: application/vnd.thanx-v1+json"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "user": {
      "id": "fgr2349gh",
      "email": "jane.smith@example.com",
      "first_name": "Jane"
    }
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fgr2349gh"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint updates the specified user&#39;s information.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /merchants/:merchant_id/users/:user_id</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>Optional</td>
<td>User&#39;s email address</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>string</td>
<td>Optional</td>
<td>User&#39;s first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>string</td>
<td>Optional</td>
<td>User&#39;s last name</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>string</td>
<td>Optional</td>
<td>User&#39;s birth date in the format YYYY-MM-DD</td>
</tr>
</tbody></table>
<h2 id='create-access-token'>Create access token</h2><pre class="highlight shell"><code>curl https://merchant.thanxsandbox.io/merchants/1/users/2/token <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -H <span class="s2">"Accept: application/vnd.thanx-v1+json"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span> <span class="se">\</span>
  -d <span class="s1">'{ "scope": "web" }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"web"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1577836800</span><span class="p">,</span><span class="w">
  </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"300"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint will create and return an access token for the user</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>PATCH /merchants/:merchant_id/users/:user_id</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>scope</code></td>
<td>string</td>
<td>Required</td>
<td><code>sdk</code> for SDK - multi-use and long-lived<br><code>web</code> for web embed - single-use and short-lived</td>
</tr>
</tbody></table>
<h1 id='legacy-ordering-loyalty-integration'>[LEGACY] Ordering / Loyalty Integration</h1>
<blockquote>
<p>API Endpoint</p>
</blockquote>
<pre class="highlight plaintext"><code>https://loyalty.thanxsandbox.com/api
</code></pre>
<p>This section describes API endpoints that enable an online ordering platform to
integrate with Thanx. This API provides a way to retrieve a user&#39;s rewards and
apply discounts to their basket. An online ordering platform with a Thanx
merchant as a customer can use this API to allow Thanx users to use their
discounts when making purchases online. The <code>GET /account</code> endpoint provides a
user&#39;s available rewards. The <code>POST /baskets</code> endpoint computes a discount and
marks rewards as used in the Thanx system. Integrators are expected to apply
the discount to the basket.</p>
<h2 id='custom-ordering-ui'>Custom Ordering UI</h2>
<blockquote>
<p>Example Olo API requests:</p>
</blockquote>
<pre class="highlight plaintext"><code># Exchange Thanx Token for Olo Token:
POST /users/getorcreate
{
  provider:       'thanx', # name of loyalty provider
  providertoken:  '...',   # thanx access token
  provideruserid: '...'    # thanx user id
}

# Fetch Thanx Rewards:
GET /baskets/{uid}/loyaltyrewards/qualifying?authtoken={olo token}&amp;...
</code></pre>
<p>For merchants looking to build a custom ordering UI, there is no additional
integration work required outside of the <a href="#sso">SSO integration</a>, since
ordering providers like Olo and Brandibble have already built integrations with
Thanx as documented in below.</p>

<p><img src="images/ordering-loyalty/custom-ui-9206b5f8.png" alt="Custom Ordering UI" /></p>

<p>After the custom ordering UI authenticates the Thanx User, the Thanx token is
passed to the ordering provider. The ordering provider in turn uses that access
token to fetch qualifying rewards from the Thanx APIs.</p>
<h2 id='headers'>Headers</h2>
<p>All Ordering / Loyalty integration API endpoints described below must include
the following headers.</p>

<table><thead>
<tr>
<th>Header</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>Authorization</code></td>
<td>string</td>
<td>Required</td>
<td>All Thanx Loyalty API endpoints are protected and must be authorized via end user access tokens. These access tokens can be retrieved through an integration with Thanx SSO. The format of the header should be: <code>Bearer access_token</code></td>
</tr>
<tr>
<td><code>Content-Type</code></td>
<td>string</td>
<td>Required</td>
<td>The only accepted value is <code>application/json</code></td>
</tr>
<tr>
<td><code>Accept</code></td>
<td>string</td>
<td>Required</td>
<td>The Accept header specifies which version of the Thanx API that should be used. The current version is <code>v1</code> for the vendor <code>thanx</code>. This header is required for every request. The value should be <code>application/vnd.thanx-v1+json</code>. Thanx will notify you when a new API version is available.</td>
</tr>
<tr>
<td><code>Merchant-Key</code></td>
<td>string</td>
<td>Required</td>
<td>The Merchant key header identifies the merchant in Thanx. The value for this key will be provided to you by Thanx and is the same in production and sandbox.</td>
</tr>
</tbody></table>
<h2 id='retrieve-account'>Retrieve Account</h2><pre class="highlight shell"><code>curl https://loyalty.thanxsandbox.com/api/account?location_uid<span class="o">=</span>8bda69 <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/vnd.thanx-v1+json"</span> <span class="se">\</span>
  -H <span class="s2">"Merchant-Key: cb71e3"</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wer23gtTT"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"rewards"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gheTfR"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="s2">"minimum"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="s2">"maximum"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A free hamburger"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"redeemable"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amount"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"234234-23423423"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"3458-345345"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"fine_print"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cannot be applied to alcohol"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"retire_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-05-01T20:00:00Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"progress"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"percentage"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="s2">"towards"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$5 off next purchase"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (401 Unauthorized)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">401</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There was an error authenticating you."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint allows the retrieval of a user account information, including the
user&#39;s rewards. By default, only rewards available to use at the current time
are returned.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET /account</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>location_uid</code></td>
<td>string</td>
<td>Optional</td>
<td>The location identifier; this is what your system uses to identify a location. Providing this information allows Thanx to return rewards that can be used at this location.</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>The identifier for the user&#39;s account</td>
</tr>
<tr>
<td><code>email</code></td>
<td>string</td>
<td>The user&#39;s email</td>
</tr>
<tr>
<td><code>rewards</code></td>
<td>array(hash)</td>
<td>The user&#39;s available rewards for the merchant specified in the header. This array can be empty.</td>
</tr>
<tr>
<td><code>rewards.id</code></td>
<td>string</td>
<td>The Reward Identifier</td>
</tr>
<tr>
<td><code>rewards.value</code></td>
<td>number</td>
<td>The value of the discount, present for &#39;amount&#39; and &#39;percent&#39; types</td>
</tr>
<tr>
<td><code>rewards.minimum</code></td>
<td>number</td>
<td>The minimum spend for this reward, if applicable</td>
</tr>
<tr>
<td><code>rewards.maximum</code></td>
<td>number</td>
<td>The maximum discount possible for this reward, if applicable</td>
</tr>
<tr>
<td><code>rewards.label</code></td>
<td>string</td>
<td>The reward description</td>
</tr>
<tr>
<td><code>rewards.state</code></td>
<td>enum</td>
<td>The state of the reward (<code>redeemable</code>, <code>unredeemable</code>)</td>
</tr>
<tr>
<td><code>rewards.type</code></td>
<td>enum</td>
<td>The type of reward (<code>amount</code>, <code>percent</code>, <code>item</code>)</td>
</tr>
<tr>
<td><code>rewards.products</code></td>
<td>array(string)</td>
<td>POS Identifiers for items this discount applies to, if applicable</td>
</tr>
<tr>
<td><code>rewards.fine_print</code></td>
<td>string</td>
<td>Any fine print for the reward.</td>
</tr>
<tr>
<td><code>rewards.retire_at</code></td>
<td>string</td>
<td>Time the reward will be automatically retired in ISO8601-format if a retire date is set</td>
</tr>
<tr>
<td><code>progress</code></td>
<td>hash</td>
<td>A user&#39;s progress toward their next loyalty reward</td>
</tr>
<tr>
<td><code>progress.percentage</code></td>
<td>integer</td>
<td>Percent progress toward the next loyalty reward</td>
</tr>
<tr>
<td><code>progress.towards</code></td>
<td>string</td>
<td>Description of progress toward the next loyalty reward</td>
</tr>
</tbody></table>
<h2 id='create-amp-update-basket'>Create &amp; Update Basket</h2><pre class="highlight shell"><code>curl https://loyalty.thanxsandbox.com/api/baskets <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer 945148251b603ae34561d90acfe4050e67494d6d1e65d4d3d52798407f03c0bd"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/vnd.thanx-v1+json"</span> <span class="se">\</span>
  -H <span class="s2">"Merchant-Key: cb71e3"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "id": "gwer-werwr-2134-rty",
    "state": "billed",
    "order_timestamp": "2019-05-08T18:02:05Z",
    "location_uid": "LG-567fhwer",
    "rewards": [
      "fheTRR"
    ],
    "payments": [
      {
        "issuer": "visa",
        "last4": "1234",
        "amount": 10.45,
        "authorized_at": "2019-05-07T18:02:05Z"
      }
    ],
    "items": [
      {
        "id": "ng-23492",
        "name": "Cheese Pizza",
        "price": 9.95,
        "categories": [
          "pizza",
          "vegetarian"
        ]
      }
    ],
    "subtotal": 23.45
  }'</span>
</code></pre>
<blockquote>
<p>Response (200 OK)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fhwerwe-23663-ryryre"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checkout"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.25"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (400 Bad Request)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The reward was not found in our system"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Response (401 Unauthorized)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">401</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There was an error authenticating you."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint is used to notify Thanx of the states that a basket can be in and
receive reward redemption information in return. A basket can be in one of the
following states:</p>

<ul>
<li><code>checkout</code>

<ul>
<li>refers to any point before the order is placed. Any time the user updates
their basket or rewards, Thanx expects to receive a request to check if
discount information should be updated.</li>
</ul></li>
<li><code>placed</code>

<ul>
<li>refers to when an order has been submitted to the system and a user can no
longer modify their order through the website.</li>
</ul></li>
<li><code>billed</code>

<ul>
<li>refers to when the order has been trasmitted to the POS and the user&#39;s
credit card has been charged.</li>
</ul></li>
<li><code>completed</code>

<ul>
<li>refers to when the order has been made and transferred to the customer.</li>
</ul></li>
<li><code>voided</code>

<ul>
<li>refers to an order that got canceled after entering the placed state and
before entering the billed state.</li>
</ul></li>
<li><code>refunded</code>

<ul>
<li>refers to an order being refunded / canceled any time after it enters the
billed state.</li>
</ul></li>
</ul>

<aside class="notice">
  Thanx will mark a reward as used and grant loyalty reward progress when the
  reward enters the `billed` state.
</aside>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /baskets</code></p>
<h3 id='request'>Request</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Required</td>
<td>Basket unique ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>Required</td>
<td>Basket state (<code>checkout</code>, <code>placed</code>, <code>billed</code>, <code>completed</code>, <code>voided</code>, <code>refunded</code>)</td>
</tr>
<tr>
<td><code>order_timestamp</code></td>
<td>string</td>
<td>Optional</td>
<td>When the order is wanted in (ISO 8601 format). If this timestamp is not provided, Thanx assumes the order is wanted ASAP. Providing this timestamp allows Thanx to determine if a reward will be valid in the future (for example, for a weekend only promotion where the user orders in advance)</td>
</tr>
<tr>
<td><code>location_uid</code></td>
<td>string</td>
<td>Optional</td>
<td>The location identifier; this is what your system uses to identify a location. Providing this information allows Thanx to apply location restricted rewards.</td>
</tr>
<tr>
<td><code>rewards</code></td>
<td>array(string)</td>
<td>Required</td>
<td>Reward IDs to apply to the basket. If you are integrating with reward codes, provide the reward code here instead.</td>
</tr>
<tr>
<td><code>payments</code></td>
<td>array(hash)</td>
<td>Required</td>
<td>Array of payment methods</td>
</tr>
<tr>
<td><code>payments.issuer</code></td>
<td>string</td>
<td>Required</td>
<td>Issuer of the payment method</td>
</tr>
<tr>
<td><code>payments.last4</code></td>
<td>string</td>
<td>Required</td>
<td>Last 4 digits of the payment method</td>
</tr>
<tr>
<td><code>payments.amount</code></td>
<td>decimal</td>
<td>Required</td>
<td>Amount used for the payment method</td>
</tr>
<tr>
<td><code>payments.authorized_at</code></td>
<td>string</td>
<td>Required</td>
<td>The timestamp of when the authorization was submitted to the issuer, in ISO8601 format</td>
</tr>
<tr>
<td><code>items</code></td>
<td>array(hash)</td>
<td>Required</td>
<td>Array of items</td>
</tr>
<tr>
<td><code>items.id</code></td>
<td>string</td>
<td>Required</td>
<td>Item ID in your system / POS</td>
</tr>
<tr>
<td><code>items.name</code></td>
<td>string</td>
<td>Required</td>
<td>Item name</td>
</tr>
<tr>
<td><code>items.price</code></td>
<td>decimal</td>
<td>Required</td>
<td>Item amount</td>
</tr>
<tr>
<td><code>items.categories</code></td>
<td>array(string)</td>
<td>Optional</td>
<td>categories that describe this item</td>
</tr>
<tr>
<td><code>subtotal</code></td>
<td>decimal</td>
<td>Required</td>
<td>The subtotal of the basket in USD (before taxes &amp; tips)</td>
</tr>
</tbody></table>
<h3 id='response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>Response ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td>enum</td>
<td>Basket state (<code>checkout</code>, <code>placed</code>, <code>billed</code>, <code>completed</code>, <code>voided</code>, <code>refunded</code>)</td>
</tr>
<tr>
<td><code>discount</code></td>
<td>string</td>
<td>Discount to apply</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="curl">curl</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
